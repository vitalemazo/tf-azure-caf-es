{
  "version": 4,
  "terraform_version": "1.3.7",
  "serial": 1010,
  "lineage": "9a8c86fa-fd1f-a839-694d-32e99e1f91d8",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NTYyNzc5NjUtMjkzOC00OTIyLTlhNjEtZDk1NmI5ZTAyMTJmO3N1YnNjcmlwdGlvbklkPTY1OWRiOTVjLWQ4NDAtNGNlMC05YTZlLTY4YWMwMDc3ZDhkNTt0ZW5hbnRJZD01NjU5NjZkNy0yYmUyLTQ3YjEtOGE3ZC02ODFjYTFhOGY5MjU=",
            "object_id": "56277965-2938-4922-9a61-d956b9e0212f",
            "subscription_id": "659db95c-d840-4ce0-9a6e-68ac0077d8d5",
            "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NTYyNzc5NjUtMjkzOC00OTIyLTlhNjEtZDk1NmI5ZTAyMTJmO3N1YnNjcmlwdGlvbklkPTY1OWRiOTVjLWQ4NDAtNGNlMC05YTZlLTY4YWMwMDc3ZDhkNTt0ZW5hbnRJZD01NjU5NjZkNy0yYmUyLTQ3YjEtOGE3ZC02ODFjYTFhOGY5MjU=",
            "object_id": "56277965-2938-4922-9a61-d956b9e0212f",
            "subscription_id": "659db95c-d840-4ce0-9a6e-68ac0077d8d5",
            "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NTYyNzc5NjUtMjkzOC00OTIyLTlhNjEtZDk1NmI5ZTAyMTJmO3N1YnNjcmlwdGlvbklkPTY1OWRiOTVjLWQ4NDAtNGNlMC05YTZlLTY4YWMwMDc3ZDhkNTt0ZW5hbnRJZD01NjU5NjZkNy0yYmUyLTQ3YjEtOGE3ZC02ODFjYTFhOGY5MjU=",
            "object_id": "56277965-2938-4922-9a61-d956b9e0212f",
            "subscription_id": "659db95c-d840-4ce0-9a6e-68ac0077d8d5",
            "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "external_lookup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the private cluster feature for your Azure Kubernetes Service cluster to ensure network traffic between your API server and your node pools remains on the private network only. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Azure Kubernetes Service Private Clusters should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.1\"}",
            "name": "040732e8-d947-40b8-95d6-854c95024bf8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Service Bus to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "04d53d87-841c-4f23-8a5b-21564380b55e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ServiceBus/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"VNetAndIPFilteringLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.",
            "display_name": "Azure API for FHIR should use a customer-managed key to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
            "management_group_name": null,
            "metadata": "{\"category\":\"API for FHIR\",\"version\":\"1.1.0\"}",
            "name": "051cba44-2429-45b9-9649-46cec11c7119",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.HealthcareApis/services/cosmosDbConfiguration.keyVaultKeyUri\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux VMs if the VM Image (OS) is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux VMs. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "053d3325-282c-4e5c-b944-24faffd30d77",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
          "schema_version": 0,
          "attributes": {
            "description": "To access the private endpoint(s) for Storage Sync Service resource interfaces from a registered server, you need to configure your DNS to resolve the correct names to your private endpoint's private IP addresses. This policy creates the requisite Azure Private DNS Zone and A records for the interfaces of your Storage Sync Service private endpoint(s).",
            "display_name": "Configure Azure File Sync to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.0\"}",
            "name": "06695360-db88-47f6-b976-7500d4297475",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"privateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"afs\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-afs\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f\",\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f",
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machines if the virtual machine image is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.1\"}",
            "name": "0868462e-646c-4fe3-9ced-a733534b6a2c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example values: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Search Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "08ba64b8-738f-4918-9686-730d2ed79c7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Search/searchServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
          "schema_version": 0,
          "attributes": {
            "description": "By default, a virtual machine's OS and data disks are encrypted-at-rest using platform-managed keys. Temp disks, data caches and data flowing between compute and storage aren't encrypted. Disregard this recommendation if: 1. using encryption-at-host, or 2. server-side encryption on Managed Disks meets your security requirements. Learn more in: Server-side encryption of Azure Disk Storage: https://aka.ms/disksse, Different disk encryption offerings: https://aka.ms/diskencryptioncomparison",
            "display_name": "Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"2.0.3\"}",
            "name": "0961003e-5a0a-4549-abde-af6a37f2724d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.Compute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"d57a4221-a804-52ca-3dea-768284f06bb7\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Web PubSub service. Learn more at: https://aka.ms/awps/privatelink.",
            "display_name": "Configure Azure Web PubSub Service to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Web PubSub\",\"version\":\"1.0.0\"}",
            "name": "0b026355-49cb-467b-8ac4-f777874e175a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"webpubsub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-webpubsub-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
          "schema_version": 0,
          "attributes": {
            "description": "This policy is deprecated. Please use /providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8 instead.",
            "display_name": "[Deprecated]: SQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"deprecated\":true,\"version\":\"2.0.1-deprecated\"}",
            "name": "0d134df8-db83-46fb-ad72-fe0c9428c8dd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.Sql/servers/encryptionProtector/serverKeyType\"},{\"field\":\"Microsoft.Sql/servers/encryptionProtector/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.Sql/servers/encryptionProtector/uri\"}]},\"name\":\"current\",\"type\":\"Microsoft.Sql/servers/encryptionProtector\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that container registries are not exposed on the public internet. Creating private endpoints can limit exposure of container registry resources. Learn more at: https://aka.ms/acr/portal/public-network and https://aka.ms/acr/private-link.",
            "display_name": "Public network access should be disabled for Container registries",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.0\"}",
            "name": "0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "PostgreSQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "name": "18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforPostgreSQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"8.0.1\"}",
            "name": "1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"extensions\",\"networking.k8s.io\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Ingress\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/ingress-https-only/v1/template.yaml\"}},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.",
            "display_name": "Public network access on Azure SQL Database should be disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.1.0\"}",
            "name": "1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machines if the virtual machine image is in the list defined and the agent is not installed.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "name": "1c210e94-a481-4beb-95fa-1571b434fb04",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Synapse workspace. Learn more at: https://docs.microsoft.com/azure/synapse-analytics/security/how-to-connect-to-workspace-from-restricted-network#appendix-dns-registration-for-private-endpoint.",
            "display_name": "Configure Azure Synapse workspaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"2.0.0\"}",
            "name": "1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone Id\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"targetSubResource\":{\"type\":\"String\",\"allowedValues\":[\"Dev\",\"Sql\",\"SqlOnDemand\"],\"defaultValue\":\"Dev\",\"metadata\":{\"description\":\"Target sub resource the private endpoint connects to\",\"displayName\":\"Target sub-resource\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Synapse/workspaces\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('targetSubResource')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"synapse-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Event Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ArchiveLogs\",\"enabled\":true,\"retentionPolicy\":{\"days\":0,\"enabled\":false}},{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AutoScaleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaCoordinatorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaUserErrorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EventHubVNetConnectionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CustomerManagedKeyUserLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RuntimeAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationMetricsLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventHub/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"anyOf\":[{\"allOf\":[{\"equals\":\"false\",\"value\":\"[parameters('logsEnabled')]\"},{\"equals\":\"false\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\"}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('logsEnabled')]\"},{\"anyOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\",\"in\":[\"ArchiveLogs\",\"OperationalLogs\",\"AutoScaleLogs\",\"KafkaCoordinatorLogs\",\"KafkaUserErrorLogs\",\"EventHubVNetConnectionEvent\",\"CustomerManagedKeyUserLogs\",\"RuntimeAuditLogs\",\"ApplicationMetricsLogs\"]}]}},\"equals\":9},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AllLogs\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].categoryGroup\"}]}},\"equals\":1}]}]}]},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.",
            "display_name": "Configure Azure Defender for Key Vaults to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "1f725891-01c0-420a-9059-4fa46cb770b7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"KeyVaults\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"KeyVaults\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/cosmosdb-cmk.",
            "display_name": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.1.0\"}",
            "name": "1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"exists\":false,\"field\":\"Microsoft.DocumentDB/databaseAccounts/keyVaultKeyUri\"},{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public endpoint allows you to restrict access to your Storage Sync Service resource to requests destined to approved private endpoints on your organization's network. There is nothing inherently insecure about allowing requests to the public endpoint, however, you may wish to disable it to meet regulatory, legal, or organizational policy requirements. You can disable the public endpoint for a Storage Sync Service by setting the incomingTrafficPolicy of the resource to AllowVirtualNetworksOnly.",
            "display_name": "Public network access should be disabled for Azure File Sync",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.StorageSync/storageSyncServices\",\"field\":\"type\"},{\"field\":\"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\"notEquals\":\"AllowVirtualNetworksOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for DNS provides an additional layer of protection for your cloud resources by continuously monitoring all DNS queries from your Azure resources. Azure Defender alerts you about suspicious activity at the DNS layer. Learn more about the capabilities of Azure Defender for DNS at https://aka.ms/defender-for-dns . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .",
            "display_name": "Configure Azure Defender for DNS to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"Dns\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Dns\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.StreamAnalytics/streamingjobs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Execution\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Authoring\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
            "display_name": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"location\":\"Global\",\"name\":\"subscriptionToLa\",\"properties\":{\"logs\":[{\"category\":\"Administrative\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Security\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ServiceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Alert\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Recommendation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Policy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ResourceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Insights/diagnosticSettings\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"existenceScope\":\"Subscription\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for File Services to stream resource logs to a Log Analytics workspace when any file Service which is missing this diagnostic settings is created or updated.",
            "display_name": "Configure diagnostic settings for File Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.0\"}",
            "name": "25a70cc8-2bd4-47f1-90b6-1478e4662c96",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"fileServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/fileServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Table Services to stream resource logs to a Log Analytics workspace when any table Service which is missing this diagnostic settings is created or updated. Note: This policy is not triggered upon Storage Account creation and requires creation of a remediation task in order to update for the account.",
            "display_name": "Configure diagnostic settings for Table Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.1\"}",
            "name": "2fb86bf3-d221-43d1-96d1-2434af34eaa0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from the dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"tableServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/tableServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/tableServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "[Preview]: Log Analytics Extension should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "name": "32133ab0-ee4b-4b44-98d6-042180979d50",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
          "schema_version": 0,
          "attributes": {
            "description": "Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges",
            "display_name": "Storage accounts should restrict network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.1\"}",
            "name": "34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your Azure SQL Servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.1.0\"}",
            "name": "36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-11-01-preview\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/securityAlertPolicies.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"},\"effect\":\"DeployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machine scale sets if the virtual machine image is in the list defined and the agent is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machines in the set by updating them.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "name": "3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machine scale sets if the virtual machine image is in the list defined and the extension is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machine in the set by updating them. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.1\"}",
            "name": "3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Monitor private link scope. Learn more at: https://docs.microsoft.com/azure/azure-monitor/logs/private-link-security#connect-to-a-private-endpoint.",
            "display_name": "Configure Azure Monitor Private Link Scope to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "437914ee-c176-4fff-8986-7e05eb971365",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId1\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone to your Azure Monitor Private Link scope.\",\"displayName\":\"Private DNS Zone for global endpoints used by Azure Monitor\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId2\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone to your Azure Monitor Private Link scope.\",\"displayName\":\"Private DNS Zone for workspace-specific mapping to OMS agents endpoints\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId3\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone to your Azure Monitor Private Link scope.\",\"displayName\":\"Private DNS Zone for workspace-specific mapping to ingestion endpoints\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId4\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone for workspace-specific mapping to the agent service automation endpoints\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId5\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone for connectivity to the global agent's solution packs storage account\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Insights/privateLinkScopes\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"azuremonitor\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId1\":{\"value\":\"[parameters('privateDnsZoneId1')]\"},\"privateDnsZoneId2\":{\"value\":\"[parameters('privateDnsZoneId2')]\"},\"privateDnsZoneId3\":{\"value\":\"[parameters('privateDnsZoneId3')]\"},\"privateDnsZoneId4\":{\"value\":\"[parameters('privateDnsZoneId4')]\"},\"privateDnsZoneId5\":{\"value\":\"[parameters('privateDnsZoneId5')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId1\":{\"type\":\"string\"},\"privateDnsZoneId2\":{\"type\":\"string\"},\"privateDnsZoneId3\":{\"type\":\"string\"},\"privateDnsZoneId4\":{\"type\":\"string\"},\"privateDnsZoneId5\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone1\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId1')]\"}},{\"name\":\"privateDnsZone2\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId2')]\"}},{\"name\":\"privateDnsZone3\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId3')]\"}},{\"name\":\"privateDnsZone4\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId4')]\"}},{\"name\":\"privateDnsZone5\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId5')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure HDInsight clusters. Learn more at: https://aka.ms/hdi.pl.",
            "display_name": "Configure Azure HDInsight clusters to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
            "management_group_name": null,
            "metadata": "{\"category\":\"HDInsight\",\"version\":\"1.0.0\"}",
            "name": "43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"groupId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Target group id (sub resource type) for the private endpoint.\",\"displayName\":\"Group ID\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Azure HDInsight clusters to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for Azure HDInsight clusters\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.HDInsight/clusters\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('groupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"hdinsightCluster-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for open-source relational databases detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Learn more about the capabilities of Azure Defender for open-source relational databases at https://aka.ms/AzDforOpenSourceDBsDocu. Important: Enabling this plan will result in charges for protecting your open-source relational databases. Learn about the pricing on Security Center's pricing page: https://aka.ms/pricing-security-center",
            "display_name": "Configure Azure Defender for open-source relational databases to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"OpenSourceRelationalDatabases\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"OpenSourceRelationalDatabases\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.",
            "display_name": "Deploy Dependency agent for Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"5.0.0\"}",
            "name": "4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-sp4-gen2\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
          "schema_version": 0,
          "attributes": {
            "description": "Private DNS records allow private connections to private endpoints. Private endpoint connections allow secure communication by enabling private connectivity to Batch accounts without a need for public IP addresses at the source or destination. For more information on private endpoints and DNS zones in Batch, see https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints that connect to Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "name": "4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private DNS Zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"batchAccount\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"batchAccount-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Configure Azure Defender for SQL servers on machines to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"SqlServerVirtualMachines\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServerVirtualMachines\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the key vault firewall so that the key vault is not accessible by default to any public IPs. You can then configure specific IP ranges to limit access to those networks. Learn more at: https://docs.microsoft.com/azure/key-vault/general/network-security",
            "display_name": "Azure Key Vault should have firewall enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"3.0.0\"}",
            "name": "55615ac9-af46-4a59-874e-391cc3dfb490",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/createMode\",\"notEquals\":\"recover\"},{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Storage accounts to stream resource logs to a Log Analytics workspace when any storage accounts which is missing this diagnostic settings is created or updated.",
            "display_name": "Configure diagnostic settings for Storage Accounts to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.0\"}",
            "name": "59759c62-9a22-4cdf-ae64-074495983fef",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from the dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"storageAccountsDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK.",
            "display_name": "Container registries should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.1.2\"}",
            "name": "5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/encryption.status\",\"notEquals\":\"enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "Log Analytics extension should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for PostgreSQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for PostgreSQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"3.0.0\"}",
            "name": "5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleServers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/createMode\",\"notEquals\":\"Update\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.privateDnsZoneArmResourceId\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the extension is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. Deprecation notice: The Log Analytics agent will not be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux virtual machine scale sets. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
          "schema_version": 0,
          "attributes": {
            "description": "Customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about customer-managed keys at https://go.microsoft.com/fwlink/?linkid=2121321.",
            "display_name": "Cognitive Services accounts should enable data encryption with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"2.0.0\"}",
            "name": "67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"Microsoft.CognitiveServices/accounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"},{\"count\":{\"field\":\"Microsoft.CognitiveServices/accounts/capabilities[*]\",\"where\":{\"equals\":\"CustomerManagedKey\",\"field\":\"Microsoft.CognitiveServices/accounts/capabilities[*].name\"}},\"greater\":0}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "name": "69af7d4a-7b18-4044-93a9-2651498ef203",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Kubernetes Service to stream resource logs to a Log Analytics workspace.",
            "display_name": "Deploy - Configure diagnostic settings for Azure Kubernetes Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"3.0.0\"}",
            "name": "6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "parameters": "{\"AllMetrics\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AllMetrics logs to the Log Analytics workspace - True or False\",\"displayName\":\"AllMetrics - Enabled\"}},\"cloud-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cloud-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"cloud-controller-manager - Enabled\"}},\"cluster-autoscaler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cluster-autoscaler logs to the Log Analytics workspace - True or False\",\"displayName\":\"cluster-autoscaler - Enabled\"}},\"csi-azuredisk-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azuredisk-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azuredisk-controller - Enabled\"}},\"csi-azurefile-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azurefile-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azurefile-controller - Enabled\"}},\"csi-snapshot-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-snapshot-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-snapshot-controller - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"AzureKubernetesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"guard\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream guard logs to the Log Analytics workspace - True or False\",\"displayName\":\"guard - Enabled\"}},\"kube-apiserver\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-apiserver logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-apiserver - Enabled\"}},\"kube-audit\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit - Enabled\"}},\"kube-audit-admin\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit-admin logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit-admin - Enabled\"}},\"kube-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-controller-manager - Enabled\"}},\"kube-scheduler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-scheduler logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-scheduler - Enabled\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the Azure Kubernetes Service should be connected to\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AllMetrics\":{\"value\":\"[parameters('AllMetrics')]\"},\"cloud-controller-manager\":{\"value\":\"[parameters('cloud-controller-manager')]\"},\"cluster-autoscaler\":{\"value\":\"[parameters('cluster-autoscaler')]\"},\"csi-azuredisk-controller\":{\"value\":\"[parameters('csi-azuredisk-controller')]\"},\"csi-azurefile-controller\":{\"value\":\"[parameters('csi-azurefile-controller')]\"},\"csi-snapshot-controller\":{\"value\":\"[parameters('csi-snapshot-controller')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"guard\":{\"value\":\"[parameters('guard')]\"},\"kube-apiserver\":{\"value\":\"[parameters('kube-apiserver')]\"},\"kube-audit\":{\"value\":\"[parameters('kube-audit')]\"},\"kube-audit-admin\":{\"value\":\"[parameters('kube-audit-admin')]\"},\"kube-controller-manager\":{\"value\":\"[parameters('kube-controller-manager')]\"},\"kube-scheduler\":{\"value\":\"[parameters('kube-scheduler')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AllMetrics\":{\"type\":\"string\"},\"cloud-controller-manager\":{\"type\":\"string\"},\"cluster-autoscaler\":{\"type\":\"string\"},\"csi-azuredisk-controller\":{\"type\":\"string\"},\"csi-azurefile-controller\":{\"type\":\"string\"},\"csi-snapshot-controller\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"guard\":{\"type\":\"string\"},\"kube-apiserver\":{\"type\":\"string\"},\"kube-audit\":{\"type\":\"string\"},\"kube-audit-admin\":{\"type\":\"string\"},\"kube-controller-manager\":{\"type\":\"string\"},\"kube-scheduler\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('AllMetrics')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerService/managedClusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"count\":{\"name\":\"logCategoriesParameter\",\"value\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"where\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[current('logCategoriesParameter').enabled]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"[current('logCategoriesParameter').category]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greater\":0}},\"equals\":11},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"allOf\":[{\"equals\":\"AllMetrics\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('AllMetrics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}},\"greater\":0},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. You need private DNS zone properly configured to connect to Azure Automation account via Azure Private Link. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Automation accounts with private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
            "management_group_name": null,
            "metadata": "{\"category\":\"Automation\",\"version\":\"1.0.0\"}",
            "name": "6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateEndpointGroupId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A group Id for the private endpoint\",\"displayName\":\"Private endpoint group id\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"[parameters('privateEndpointGroupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"[parameters('privateEndpointGroupId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointGroupId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"automationAccounts-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a file groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for file groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "6df98d03-368a-4438-8730-a93c4d7693d6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a file groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for file groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"file\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
          "schema_version": 0,
          "attributes": {
            "description": "Secure your blob and file storage account with greater flexibility using customer-managed keys. When you specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. Using customer-managed keys provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.",
            "display_name": "Storage accounts should use customer-managed key for encryption",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.3\"}",
            "name": "6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"not\":{\"equals\":\"Microsoft.Keyvault\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.keySource\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Storage provides detections of unusual and potentially harmful attempts to access or exploit storage accounts.",
            "display_name": "Configure Azure Defender for Storage to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "74c30959-af11-47b3-9ed2-a26e03f427a3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"StorageAccounts\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"StorageAccounts\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access on a Batch account improves security by ensuring your Batch account can only be accessed from a private endpoint. Learn more about disabling public network access at https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Public network access should be disabled for Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "name": "74c5a0ae-5e48-4738-b093-65e23a060488",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
          "schema_version": 0,
          "attributes": {
            "description": "Enable resource logs for public IP addressess in diagnostic settings to stream to a Log Analytics workspace. Get detailed visibility into attack traffic and actions taken to mitigate DDoS attacks via notifications, reports and flow logs.",
            "display_name": "Public IP addresses should have resource logs enabled for Azure DDoS Protection Standard",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The target Log Analytics workspace for the diagnostic settings\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Enable Logs - True or False\",\"displayName\":\"Enable Logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Enable Metrics - True or False\",\"displayName\":\"Enable Metrics\"}},\"profileName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Profile name for the Azure diagnostic settings resource\",\"displayName\":\"Diagnostic setting name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"name\":{\"value\":\"[field('name')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('name'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DDoSProtectionNotifications\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationFlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationReports\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/publicIPAddresses/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('LogsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('MetricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Azure Migrate project. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Migrate resources to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Migrate\",\"version\":\"1.0.0\"}",
            "name": "7590a335-57cf-4c95-babd-ecbc8fafeb1f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"equals\":\"Default\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"},{\"anyOf\":[{\"contains\":\"Microsoft.Migrate/assessmentProjects\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"contains\":\"Microsoft.Migrate/migrateProjects\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"contains\":\"Microsoft.OffAzure/masterSites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"}]}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"default-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a blob groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for blob groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "75973700-529f-4de2-b794-fb9b6781b6b0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a blob groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for blob groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"blob\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Deploy Dependency agent for Linux virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"5.0.0\"}",
            "name": "765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-sp4-gen2\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that your CosmosDB account isn't exposed on the public internet. Creating private endpoints can limit exposure of your CosmosDB account. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation.",
            "display_name": "Azure Cosmos DB should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.0.0\"}",
            "name": "797b37f7-06b8-444c-b1ad-fc62867f335a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve app configuration instances. Learn more at: https://aka.ms/appconfig/private-endpoint.",
            "display_name": "Configure private DNS zones for private endpoints connected to App Configuration",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Configuration\",\"version\":\"1.0.0\"}",
            "name": "7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"configurationStores\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-azconfig-io\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Queue Services to stream resource logs to a Log Analytics workspace when any queue Service which is missing this diagnostic settings is created or updated. Note: This policy is not triggered upon Storage Account creation and requires creation of a remediation task in order to update for the account.",
            "display_name": "Configure diagnostic settings for Queue Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.1\"}",
            "name": "7bd000e3-37c7-4928-9f31-86c4b77c5c45",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"queueServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/queueServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/queueServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
          "schema_version": 0,
          "attributes": {
            "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Both operating systems and data disks in Azure Kubernetes Service clusters should be encrypted by customer-managed keys",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.1\"}",
            "name": "7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"False\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"},{\"equals\":\"\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Azure Cosmos DB is an Azure-native layer of security that detects attempts to exploit databases in your Azure Cosmos DB accounts.\r\nDefender for Azure Cosmos DB detects potential SQL injections, known bad actors based on Microsoft Threat Intelligence, suspicious access patterns, and potential exploitations of your database through compromised identities or malicious insiders.",
            "display_name": "Configure Microsoft Defender for Azure Cosmos DB to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "82bf5b87-728b-4a74-ba4d-6123845cf542",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"CosmosDbs\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"CosmosDbs\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a dfs groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for dfs groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a dfs groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for dfs groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"dfs\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "MySQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "name": "83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforMySQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforMySQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
          "schema_version": 0,
          "attributes": {
            "description": "Private DNS records allow private connections to private endpoints. Private endpoint connections allow secure communication by enabling private connectivity to your Azure Data Factory without a need for public IP addresses at the source or destination. For more information on private endpoints and DNS zones in Azure Data Factory, see https://docs.microsoft.com/azure/data-factory/data-factory-private-link.",
            "display_name": "Configure private DNS zones for private endpoints that connect to Azure Data Factory",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Factory\",\"version\":\"1.0.0\"}",
            "name": "86cd96e1-1745-420d-94d4-d3f2fe415aa4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfGroupIds\":{\"type\":\"Array\",\"allowedValues\":[\"dataFactory\",\"portal\"],\"defaultValue\":[\"dataFactory\",\"portal\"],\"metadata\":{\"description\":\"The list of Group Ids that can be specified for Private Endpoints.\",\"displayName\":\"Allowed Group Ids\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private DNS Zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"in\":\"[parameters('listOfGroupIds')]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"dataFactory-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.",
            "display_name": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Box\",\"version\":\"1.0.0\"}",
            "name": "86efb160-8de7-451d-bc08-5d475b0aadae",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}},\"supportedSKUs\":{\"type\":\"Array\",\"allowedValues\":[\"DataBox\",\"DataBoxHeavy\"],\"defaultValue\":[\"DataBox\",\"DataBoxHeavy\"],\"metadata\":{\"description\":\"The list of SKUs that support customer-managed key encryption key\",\"displayName\":\"Supported SKUs\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DataBox/jobs\",\"field\":\"type\"},{\"field\":\"Microsoft.Databox/jobs/sku.name\",\"in\":\"[parameters('supportedSKUs')]\"},{\"field\":\"Microsoft.DataBox/jobs/details.keyEncryptionKey.kekType\",\"notEquals\":\"CustomerManaged\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.",
            "display_name": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stream Analytics\",\"version\":\"1.1.0\"}",
            "name": "87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"SystemAccount\",\"field\":\"Microsoft.StreamAnalytics/streamingJobs/contentStoragePolicy\"},{\"equals\":\"Microsoft.StreamAnalytics/streamingJobs\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
          "schema_version": 0,
          "attributes": {
            "description": "Upgrade to the latest TLS version. We recommend all customers who are still using API Apps to implement the built-in policy called 'App Service apps should use the latest TLS version', which is scoped to include API apps in addition to Web Apps.",
            "display_name": "[Deprecated]: Latest TLS version should be used in your API App",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"deprecated\":true,\"version\":\"1.0.0-deprecated\"}",
            "name": "8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy resource group containing Log Analytics workspace and linked automation account to centralize logs and monitoring. The automation account is aprerequisite for solutions like Updates and Change Tracking.",
            "display_name": "Configure Log Analytics workspace and automation account to centralize logs and monitoring",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "parameters": "{\"automationAccountName\":{\"type\":\"String\",\"defaultValue\":\"CentralAutomationAccount\",\"metadata\":{\"description\":\"Provide name for automation account\",\"displayName\":\"automationAccountName\"}},\"automationRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for automation account\",\"displayName\":\"automationRegion\",\"strongType\":\"location\"}},\"dataRetention\":{\"type\":\"String\",\"defaultValue\":\"30\",\"metadata\":{\"description\":\"Enter the retention period in workspace, can be between 7 to 730 days. Billing is per 30 days at the minimum even when retention is shorter\",\"displayName\":\"dataRetention\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Select DeployIfNotExists to deploy central Log Analytics workspace, Audit or Disable to disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"defaultValue\":\"CentralRG\",\"metadata\":{\"description\":\"Provide name for resource group\",\"displayName\":\"rgName\"}},\"sku\":{\"type\":\"String\",\"allowedValues\":[\"pergb2018\",\"Free\",\"Standalone\",\"PerNode\",\"Standard\",\"Premium\"],\"defaultValue\":\"pergb2018\",\"metadata\":{\"description\":\"Select pricing tier. Legacy tiers (Free, Standalone, PerNode, Standard or Premium) are not available to all customers\",\"displayName\":\"sku\"}},\"workspaceName\":{\"type\":\"String\",\"defaultValue\":\"CentralWorkspace\",\"metadata\":{\"description\":\"Provide name for log analytics workspace\",\"displayName\":\"workspaceName\"}},\"workspaceRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enter Azure region for Log Analytics workspace\",\"displayName\":\"workspaceRegion\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('rgName')]\",\"deployment\":{\"location\":\"West Central US\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"automationAccountName\":{\"value\":\"[parameters('automationAccountName')]\"},\"automationRegion\":{\"value\":\"[parameters('automationRegion')]\"},\"dataRetention\":{\"value\":\"[parameters('dataRetention')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"},\"sku\":{\"value\":\"[parameters('sku')]\"},\"workspaceName\":{\"value\":\"[parameters('workspaceName')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"automationAccountName\":{\"type\":\"String\"},\"automationRegion\":{\"type\":\"String\"},\"dataRetention\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"},\"sku\":{\"type\":\"String\"},\"workspaceName\":{\"type\":\"String\"},\"workspaceRegion\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"log-analytics\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiversion\":\"2015-10-31\",\"comments\":\"Automation account for Log Analytics workapce\",\"location\":\"[parameters('AutomationRegion')]\",\"name\":\"[parameters('AutomationAccountName')]\",\"properties\":{\"sku\":{\"name\":\"OMS\"}},\"type\":\"Microsoft.Automation/automationAccounts\"},{\"apiVersion\":\"2020-08-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"enableLogAccessUsingOnlyResourcePermissions\":true,\"retentionInDays\":\"[parameters('dataRetention')]\",\"sku\":{\"name\":\"[parameters('sku')]\"}},\"resources\":[{\"apiVersion\":\"2020-08-01\",\"dependsOn\":[\"[parameters('workspaceName')]\",\"[parameters('AutomationAccountName')]\"],\"name\":\"Automation\",\"properties\":{\"resourceId\":\"[concat(subscription().id, '/resourceGroups/', parameters('rgName'), '/providers/Microsoft.Automation/automationAccounts/', parameters('AutomationAccountName'))]\"},\"type\":\"linkedServices\"}],\"type\":\"Microsoft.OperationalInsights/workspaces\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceScope\":\"resourcegroup\",\"name\":\"[parameters('workspaceName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.OperationalInsights/workspaces\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for servers provides real-time threat protection for server workloads and generates hardening recommendations as well as alerts about suspicious activities.",
            "display_name": "Configure Azure Defender for servers to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"VirtualMachines\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"VirtualMachines\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a dfs_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for dfs_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "90bd4cb3-9f59-45f7-a6ca-f69db2726671",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a dfs_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for dfs_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"dfs_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-11-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('DaExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"settings\":{},\"type\":\"[variables('DaExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"DaExtensionName\":\"DependencyAgentWindows\",\"DaExtensionType\":\"DependencyAgentWindows\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Recovery Services Vaults. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "[Preview]: Configure Azure Recovery Services vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Site Recovery\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "942bd215-1a66-44be-af65-6a1c0318dbe2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone name required to resolve a private DNS Zone to recovery services vault private endpoint records.\",\"displayName\":\"Private DNS zone Id for Azure Recovery vaults resources\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"AzureSiteRecovery\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-siterecovery\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.0\"}",
            "name": "94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "parameters": "{\"ddosPlan\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoS Protection Plan resource to be associated to the virtual networks\",\"displayName\":\"DDoS Protection Plan\",\"strongType\":\"Microsoft.Network/ddosProtectionPlans\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Modify\",\"Audit\",\"Disabled\"],\"defaultValue\":\"Modify\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"notEquals\":true},{\"equals\":\"\",\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan\"}]}]},\"then\":{\"details\":{\"conflictEffect\":\"audit\",\"operations\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"operation\":\"addOrReplace\",\"value\":true},{\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan.id\",\"operation\":\"addOrReplace\",\"value\":\"[parameters('ddosPlan')]\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"]},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"9.1.0\"}",
            "name": "98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"auditIfNotExists\",\"AuditIfNotExists\",\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"exclusionTagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding VMs from the scope of this policy. This should be used along with the Exclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Name\"}},\"exclusionTagValue\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Value of the tag to use for excluding VMs from the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Exclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Values\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"field\":\"[concat('tags[', parameters('exclusionTagName'), ']')]\",\"in\":\"[parameters('exclusionTagValue')]\"}},{\"field\":\"id\",\"notContains\":\"/resourceGroups/databricks-rg-\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"azureopenshift\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"AzureDatabricks\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter-g2\",\"2022-datacenter\",\"2022-datacenter-azure-edition\",\"2022-datacenter-azure-edition-smalldisk\",\"2022-datacenter-azure-edition-core\",\"2022-datacenter-azure-edition-core-smalldisk\",\"2022-datacenter-smalldisk-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-core-g2\",\"2022-datacenter-core\",\"2022-datacenter-core-smalldisk-g2\",\"2022-datacenter-core-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2019\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-11\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"contains\":\"ubuntu\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*20_04-lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04-lts*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmRgName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"status\":{\"type\":\"string\",\"value\":\"[concat('Backup enabled successfully for VM:', ' ', parameters('vmName'), 'Backup Vault: ', variables('vaultName'))]\"}},\"parameters\":{\"location\":{\"metadata\":{\"description\":\"Location for VM and Backup vault\"},\"type\":\"string\"},\"vmName\":{\"metadata\":{\"description\":\"Name of Azure Virtual Machines\"},\"type\":\"string\"},\"vmRgName\":{\"metadata\":{\"description\":\"Resource group containing the virtual machines.\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2016-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('vaultName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard\"},\"type\":\"Microsoft.RecoveryServices/vaults\"},{\"apiVersion\":\"2016-12-01\",\"dependsOn\":[\"[resourceId('Microsoft.RecoveryServices/vaults/', variables('vaultName'))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('vaultName'), '/', variables('backupFabric'), '/', variables('v2VmContainer'), concat(parameters('vmRgName'),';',parameters('vmName')), '/', variables('v2Vm'), concat(parameters('vmRgName'),';',parameters('vmName')))]\",\"properties\":{\"policyId\":\"[resourceId('Microsoft.RecoveryServices/vaults/backupPolicies', variables('vaultName'),variables('backupPolicy'))]\",\"protectedItemType\":\"[variables('v2VmType')]\",\"sourceResourceId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', parameters('vmRgName'), '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName'))]\"},\"type\":\"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\"}],\"variables\":{\"backupFabric\":\"Azure\",\"backupPolicy\":\"DefaultPolicy\",\"v2Vm\":\"vm;iaasvmcontainerv2;\",\"v2VmContainer\":\"iaasvmcontainer;iaasvmcontainerv2;\",\"v2VmType\":\"Microsoft.Compute/virtualMachines\",\"vaultName\":\"[take(concat('RSVault-', parameters('location'), '-', guid(resourceGroup().id)),50)]\"}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\"/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"],\"type\":\"Microsoft.RecoveryServices/backupprotecteditems\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/Batch-CMK.",
            "display_name": "Azure Batch account should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.1\"}",
            "name": "99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a web groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for web groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "9adab2a5-05ba-4fbd-831a-5bf958d04218",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a web groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for web groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"web\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Linux servers. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "name": "9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to CosmosDB account. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure CosmosDB accounts to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"2.0.0\"}",
            "name": "a63cc0bd-cda4-4178-b705-37dc439d3e0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private Dns Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateEndpointGroupId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A group Id for the private endpoint\",\"displayName\":\"Private Endpoint Group Id\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.DocumentDb/databaseAccounts\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('privateEndpointGroupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"cosmosDB-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
          "schema_version": 0,
          "attributes": {
            "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
            "display_name": "Auditing on SQL server should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "name": "a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"setting\":{\"type\":\"String\",\"allowedValues\":[\"enabled\",\"disabled\"],\"defaultValue\":\"enabled\",\"metadata\":{\"displayName\":\"Desired Auditing setting\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"[parameters('setting')]\",\"field\":\"Microsoft.Sql/auditingSettings.state\"},\"name\":\"default\",\"type\":\"Microsoft.Sql/servers/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.0.0\"}",
            "name": "a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"clusterName\":{\"value\":\"[field('name')]\"},\"clusterResourceGroupName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"clusterName\":{\"type\":\"string\"},\"clusterResourceGroupName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterGetDeploymentName')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"aksCluster\":{\"type\":\"object\",\"value\":\"[reference(resourceId(parameters('clusterResourceGroupName'), 'Microsoft.ContainerService/managedClusters', parameters('clusterName')), '2021-07-01', 'Full')]\"}},\"resources\":[]}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterUpdateDeploymentName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"aksClusterContent\":{\"value\":\"[reference(variables('clusterGetDeploymentName')).outputs.aksCluster.value]\"},\"aksClusterName\":{\"value\":\"[parameters('clusterName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"aksClusterContent\":{\"type\":\"object\"},\"aksClusterName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-07-01\",\"location\":\"[parameters('aksClusterContent').location]\",\"name\":\"[parameters('aksClusterName')]\",\"properties\":{\"aadProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'aadProfile'), parameters('aksClusterContent').properties.aadProfile, json('null'))]\",\"addonProfiles\":{\"azurepolicy\":{\"enabled\":true}},\"agentPoolProfiles\":\"[if(contains(parameters('aksClusterContent').properties, 'agentPoolProfiles'), parameters('aksClusterContent').properties.agentPoolProfiles, json('null'))]\",\"apiServerAccessProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'apiServerAccessProfile'), parameters('aksClusterContent').properties.apiServerAccessProfile, json('null'))]\",\"autoScalerProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'autoScalerProfile'), parameters('aksClusterContent').properties.autoScalerProfile, json('null'))]\",\"diskEncryptionSetID\":\"[if(contains(parameters('aksClusterContent').properties, 'diskEncryptionSetID'), parameters('aksClusterContent').properties.diskEncryptionSetID, json('null'))]\",\"dnsPrefix\":\"[parameters('aksClusterContent').properties.dnsPrefix]\",\"enablePodSecurityPolicy\":\"[if(contains(parameters('aksClusterContent').properties, 'enablePodSecurityPolicy'), parameters('aksClusterContent').properties.enablePodSecurityPolicy, json('null'))]\",\"enableRBAC\":\"[if(contains(parameters('aksClusterContent').properties, 'enableRBAC'), parameters('aksClusterContent').properties.enableRBAC, json('null'))]\",\"identityProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'identityProfile'), parameters('aksClusterContent').properties.identityProfile, json('null'))]\",\"kubernetesVersion\":\"[parameters('aksClusterContent').properties.kubernetesVersion]\",\"linuxProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'linuxProfile'), parameters('aksClusterContent').properties.linuxProfile, json('null'))]\",\"networkProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'networkProfile'), parameters('aksClusterContent').properties.networkProfile, json('null'))]\",\"nodeResourceGroup\":\"[parameters('aksClusterContent').properties.nodeResourceGroup]\",\"servicePrincipalProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'servicePrincipalProfile'), parameters('aksClusterContent').properties.servicePrincipalProfile, json('null'))]\",\"windowsProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'windowsProfile'), parameters('aksClusterContent').properties.windowsProfile, json('null'))]\"},\"sku\":\"[parameters('aksClusterContent').sku]\",\"tags\":\"[if(contains(parameters('aksClusterContent'), 'tags'), parameters('aksClusterContent').tags, json('null'))]\",\"type\":\"Microsoft.ContainerService/managedClusters\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"clusterGetDeploymentName\":\"[concat('PolicyDeployment-Get-', parameters('clusterName'))]\",\"clusterUpdateDeploymentName\":\"[concat('PolicyDeployment-Update-', parameters('clusterName'))]\"}}}},\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\"},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8\",\"/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064\"],\"type\":\"Microsoft.ContainerService/managedClusters\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
              "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to an IoT Hub device provisioning service instance. Learn more at: https://aka.ms/iotdpsvnet.",
            "display_name": "Configure IoT Hub device provisioning instances to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.0.0\"}",
            "name": "aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotDps\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices-provisioning.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to key vault. Learn more at: https://aka.ms/akvprivatelink.",
            "display_name": "[Preview]: Configure Azure Key Vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone ID to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"vault\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"keyvault-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure SignalR Service resource. Learn more at: https://aka.ms/asrs/privatelink.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints connect to Azure SignalR Service",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "management_group_name": null,
            "metadata": "{\"category\":\"SignalR\",\"version\":\"1.0.0\"}",
            "name": "b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"privatelink.service.signalr.net\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"signalr\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-service-signalr-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links a virtual network to an App Service. Learn more at: https://docs.microsoft.com/azure/app-service/networking/private-endpoint#dns.",
            "display_name": "Configure App Service apps to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.1\"}",
            "name": "b318f84a-b872-429b-ac6d-a01b96814452",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private Dns Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Web/sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"websites-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.",
            "display_name": "Configure Azure Defender for App Service to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"AppServices\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"AppServices\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Media Services account. Learn more at: https://aka.ms/mediaservicesprivatelinkdocs.",
            "display_name": "Configure Azure Media Services to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
            "management_group_name": null,
            "metadata": "{\"category\":\"Media Services\",\"version\":\"1.0.0\"}",
            "name": "b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"groupId\":{\"type\":\"String\",\"allowedValues\":[\"keydelivery\",\"liveevent\",\"streamingendpoint\"],\"metadata\":{\"description\":\"The group ID of the private endpoint.\",\"displayName\":\"Private endpoint group ID\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Media Services to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for Media Services\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Media/mediaservices\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('groupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"mediaservices-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Blob Services to stream resource logs to a Log Analytics workspace when any blob Service which is missing this diagnostic settings is created or updated.",
            "display_name": "Configure diagnostic settings for Blob Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.0\"}",
            "name": "b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"blobServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/blobServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/blobServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Resource Manager automatically monitors the resource management operations in your organization. Azure Defender detects threats and alerts you about suspicious activity. Learn more about the capabilities of Azure Defender for Resource Manager at https://aka.ms/defender-for-resource-manager . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .",
            "display_name": "Configure Azure Defender for Resource Manager to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"Arm\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Arm\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Databases to stream resource logs to a Log Analytics workspace when any SQL Database which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy - Configure diagnostic settings for SQL Databases to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"4.0.0\"}",
            "name": "b79fa14e-238a-4c2d-b376-442ce508fc84",
            "parameters": "{\"AutomaticTuningEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AutomaticTuning logs to the Log Analytics workspace - True or False\",\"displayName\":\"AutomaticTuning - Enabled\"}},\"Basic\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Basic metrics to the Log Analytics workspace - True or False\",\"displayName\":\"Basic (metric) - Enabled\"}},\"BlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Blocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Blocks - Enabled\"}},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream DatabaseWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"DatabaseWaitStatistics - Enabled\"}},\"DeadlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Deadlocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Deadlocks - Enabled\"}},\"ErrorsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Errors logs to the Log Analytics workspace - True or False\",\"displayName\":\"Errors - Enabled\"}},\"InstanceAndAppAdvanced\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream InstanceAndAppAdvanced metrics to the Log Analytics workspace - True or False\",\"displayName\":\"InstanceAndAppAdvanced (metric) - Enabled\"}},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreRuntimeStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreRuntimeStatistics - Enabled\"}},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreWaitStatistics - Enabled\"}},\"SQLInsightsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLInsights logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLInsights - Enabled\"}},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLSecurityAuditEvents logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLSecurityAuditEvents - Enabled\"}},\"TimeoutsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Timeouts logs to the Log Analytics workspace - True or False\",\"displayName\":\"Timeouts - Enabled\"}},\"WorkloadManagement\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream WorkloadManagement metrics to the Log Analytics workspace - True or False\",\"displayName\":\"WorkloadManagement (metric) - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"SQLDatabaseDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select the Log Analytics workspace from dropdown list\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notEquals\":\"master\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AutomaticTuningEnabled\":{\"value\":\"[parameters('AutomaticTuningEnabled')]\"},\"Basic\":{\"value\":\"[parameters('Basic')]\"},\"BlocksEnabled\":{\"value\":\"[parameters('BlocksEnabled')]\"},\"DatabaseWaitStatisticsEnabled\":{\"value\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},\"DeadlocksEnabled\":{\"value\":\"[parameters('DeadlocksEnabled')]\"},\"ErrorsEnabled\":{\"value\":\"[parameters('ErrorsEnabled')]\"},\"InstanceAndAppAdvanced\":{\"value\":\"[parameters('InstanceAndAppAdvanced')]\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},\"QueryStoreWaitStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},\"SQLInsightsEnabled\":{\"value\":\"[parameters('SQLInsightsEnabled')]\"},\"SQLSecurityAuditEventsEnabled\":{\"value\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"},\"TimeoutsEnabled\":{\"value\":\"[parameters('TimeoutsEnabled')]\"},\"WorkloadManagement\":{\"value\":\"[parameters('WorkloadManagement')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AutomaticTuningEnabled\":{\"type\":\"string\"},\"Basic\":{\"type\":\"string\"},\"BlocksEnabled\":{\"type\":\"string\"},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"string\"},\"DeadlocksEnabled\":{\"type\":\"string\"},\"ErrorsEnabled\":{\"type\":\"string\"},\"InstanceAndAppAdvanced\":{\"type\":\"string\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"string\"},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"string\"},\"SQLInsightsEnabled\":{\"type\":\"string\"},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"string\"},\"TimeoutsEnabled\":{\"type\":\"string\"},\"WorkloadManagement\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"SQLInsights\",\"enabled\":\"[parameters('SQLInsightsEnabled')]\"},{\"category\":\"AutomaticTuning\",\"enabled\":\"[parameters('AutomaticTuningEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},{\"category\":\"Errors\",\"enabled\":\"[parameters('ErrorsEnabled')]\"},{\"category\":\"DatabaseWaitStatistics\",\"enabled\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},{\"category\":\"Timeouts\",\"enabled\":\"[parameters('TimeoutsEnabled')]\"},{\"category\":\"Blocks\",\"enabled\":\"[parameters('BlocksEnabled')]\"},{\"category\":\"Deadlocks\",\"enabled\":\"[parameters('DeadlocksEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"}],\"metrics\":[{\"category\":\"Basic\",\"enabled\":\"[parameters('Basic')]\"},{\"category\":\"InstanceAndAppAdvanced\",\"enabled\":\"[parameters('InstanceAndAppAdvanced')]\"},{\"category\":\"WorkloadManagement\",\"enabled\":\"[parameters('WorkloadManagement')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/databases/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"SQLInsights\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLInsightsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"AutomaticTuning\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('AutomaticTuningEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreRuntimeStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Errors\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('ErrorsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"DatabaseWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DatabaseWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Timeouts\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('TimeoutsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Blocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('BlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Deadlocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DeadlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"SQLSecurityAuditEvents\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLSecurityAuditEventsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]}]}},\"equals\":10},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Basic\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('Basic')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"InstanceAndAppAdvanced\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('InstanceAndAppAdvanced')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"WorkloadManagement\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('WorkloadManagement')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}]}},\"equals\":3}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps to stream to a regional Log Analytics workspace when any Logic Apps which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Logic Apps to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "b889a06c-ec72-4b03-910a-cb169ee18721",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/workflows\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"WorkflowRuntime\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/workflows/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Configure Azure Defender for Azure SQL database to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "b99b73e7-074b-4089-9395-b7236f094491",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"SqlServers\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServers\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
          "schema_version": 0,
          "attributes": {
            "description": "Manage encryption at rest of Azure Machine Learning workspace data with customer-managed keys. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/azureml-workspaces-cmk.",
            "display_name": "Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.3\"}",
            "name": "ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"not\":{\"equals\":\"enabled\",\"field\":\"Microsoft.MachineLearningServices/workspaces/encryption.status\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid topics to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "name": "baf19753-7502-405f-8745-370519b20483",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"topic\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"topic-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to a managed disk. Learn more at: https://aka.ms/disksprivatelinksdoc.",
            "display_name": "Configure disk access resources to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "name": "bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for managed disks to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for managed disks\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Compute/diskAccesses\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"disks\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"diskAccess-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a queue groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for queue groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "bcff79fb-2b0d-47c9-97e5-3023479b00d1",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a blob groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for queue groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"queue\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Key Vault to stream to a regional Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Key Vault to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"matchWorkspace\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to require that the workspace of the diagnostic settings matches the workspace deployed by this policy\",\"displayName\":\"Workspace id must match\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzurePolicyEvaluationDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.KeyVault/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AuditEvent\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greaterOrEquals\":1},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}},\"greaterOrEquals\":1},{\"anyOf\":[{\"equals\":false,\"value\":\"[parameters('matchWorkspace')]\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Cognitive Services accounts. Learn more at: https://go.microsoft.com/fwlink/?linkid=2110097.",
            "display_name": "Configure Cognitive Services accounts to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"1.0.0\"}",
            "name": "c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Cognitive Services to resolve a private DNS Zone to your Cognitive Services account.\",\"displayName\":\"Private DNS Zone ID for Cognitive Services account\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"account\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-cognitiveservices-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Diagnostic Settings for Recovery Services Vault to stream to Log Analytics workspace for Resource specific categories. If any of the Resource specific categories are not enabled, a new diagnostic setting is created.",
            "display_name": "Deploy Diagnostic Settings for Recovery Services Vault to Log Analytics workspace for resource specific categories.",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"1.0.2\"}",
            "name": "c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "parameters": "{\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}},\"tagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Value parameter.\",\"displayName\":\"Exclusion Tag Name\"}},\"tagValue\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Value of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Name parameter.\",\"displayName\":\"Exclusion Tag Value\"}}}",
            "policy_rule": "{\"if\":{\"allof\":[{\"equals\":\"Microsoft.RecoveryServices/vaults\",\"field\":\"type\"},{\"not\":{\"equals\":\"[parameters('tagValue')]\",\"field\":\"[concat('tags[',parameters('tagName'), ']')]\"}}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"vaultName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"vaultName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"Dedicated\",\"logs\":[{\"category\":\"CoreAzureBackup\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupAlerts\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupJobs\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupPolicy\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupProtectedInstance\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupStorage\",\"enabled\":\"true\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.RecoveryServices/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allof\":[{\"Equals\":6,\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allof\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Category\",\"in\":[\"CoreAzureBackup\",\"AddonAzureBackupJobs\",\"AddonAzureBackupAlerts\",\"AddonAzureBackupPolicy\",\"AddonAzureBackupStorage\",\"AddonAzureBackupProtectedInstance\"]},{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Enabled\"}]}}},{\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\",\"notEquals\":\"\"},{\"equals\":\"Dedicated\",\"field\":\"Microsoft.Insights/diagnosticSettings/logAnalyticsDestinationType\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Batch Account to stream to a regional Log Analytics workspace when any Batch Account which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Batch Account to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "c84e5349-db6d-4769-805e-e14037dab9b5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ServiceLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Batch/batchAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for MySQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for MySQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "name": "c9299215-ae47-4f50-9c54-8a392f68a052",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/flexibleServers\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.privateDnsZoneResourceId\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private DNS provides a reliable, secure DNS service to manage and resolve domain names in a virtual network without the need to add a custom DNS solution. You can use private DNS zones to override the DNS resolution by using your own custom domain names for a private endpoint. This policy deploys a private DNS Zone for IoT Hub private endpoints.",
            "display_name": "Deploy - Configure Azure IoT Hubs to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.1.0\"}",
            "name": "c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotHub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.",
            "display_name": "Configure Microsoft Defender for Containers to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "c9ddb292-b203-4738-aead-18e2716e858f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"Containers\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Containers\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a web_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for web_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "d19ae5f1-b303-4b82-9ca8-7682749faf0c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a web_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for web_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"web_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid domains to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "name": "d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"domain\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"domain-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a blob_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for blob_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "d847d34b-9337-4e2d-99a5-767e5ac9c582",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a blob_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for blob_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"blob_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a queue_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for queue_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a queue_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for queue_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"queue_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Linux servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "deacecc0-9f84-44d2-bb82-46f32d766d43",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve to Azure Cache for Redis. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Cache for Redis to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "name": "e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource id of the private DNS zone\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"redisCache\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-redis-cache-windows-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Container Registry. Learn more at: https://aka.ms/privatednszone and https://aka.ms/acr/private-link.",
            "display_name": "Configure Container registries to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.1\"}",
            "name": "e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone id to connect to the private endpoint. It should be linked to the private endpoint's associated VNET.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"registry\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"containerRegistry-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Event Hub namespaces. Learn more at: https://docs.microsoft.com/azure/event-hubs/private-link-service.",
            "display_name": "Configure Event Hub namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Hub\",\"version\":\"1.0.0\"}",
            "name": "ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Machine Learning workspaces. Learn more at: https://docs.microsoft.com/azure/machine-learning/how-to-network-security-overview.",
            "display_name": "Configure Azure Machine Learning workspace to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.1.0\"}",
            "name": "ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"secondPrivateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Second Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"amlworkspace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"},\"secondPrivateDnsZoneId\":{\"value\":\"[parameters('secondPrivateDnsZoneId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"},\"secondPrivateDnsZoneId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":\"[if(not(empty(parameters('secondPrivateDnsZoneId'))), variables('bothPrivateDnsZoneConfigs'), variables('singlePrivateDnsZoneConfigs') )]\"},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}],\"variables\":{\"bothPrivateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}},{\"name\":\"amlworkspace-secondPrivateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('secondPrivateDnsZoneId')]\"}}],\"singlePrivateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
          "schema_version": 0,
          "attributes": {
            "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for App Service apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "display_name": "App Service apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.1\"}",
            "name": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Service Bus namespaces. Learn more at: https://docs.microsoft.com/azure/service-bus-messaging/private-link-service.",
            "display_name": "Configure Service Bus namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Bus\",\"version\":\"1.0.0\"}",
            "name": "f0fcf93c-c063-4071-9668-c47474bd3564",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.",
            "display_name": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"1.0.0\"}",
            "name": "f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/encryption.cmk.key.name\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
          "schema_version": 0,
          "attributes": {
            "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "display_name": "Function apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.1\"}",
            "name": "f9d614c5-c173-4d56-95a7-b4437057d193",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Azure Cognitive Search service. Learn more at: https://aka.ms/azure-cognitive-search/inbound-private-endpoints.",
            "display_name": "Configure Azure Cognitive Search services to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
            "management_group_name": null,
            "metadata": "{\"category\":\"Search\",\"version\":\"1.0.0\"}",
            "name": "fbc14a67-53e4-4932-abcc-2049c6706009",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"searchService\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"searchService-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
          "schema_version": 0,
          "attributes": {
            "description": "Enable export to Log Analytics workspace of Microsoft Defender for Cloud data. This policy deploys an export to Log Analytics workspace configuration with your conditions and target workspace on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.",
            "display_name": "Deploy export to Log Analytics workspace for Microsoft Defender for Cloud data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"4.1.0\"}",
            "name": "ffb6f416-7bd2-4488-8828-56585fef2be9",
            "parameters": "{\"alertSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security alerts. Determines alert severities. Example: High;Medium;Low;\",\"displayName\":\"Alert severities\"}},\"createResourceGroup\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"If a resource group does not exists in the scope, a new resource group will be created. If the resource group exists and this flag is set to 'true' the policy will re-deploy the resource group. Please note this will reset any Azure Tag on the resource group.\",\"displayName\":\"Create resource group\"}},\"exportedDataTypes\":{\"type\":\"Array\",\"allowedValues\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"defaultValue\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"metadata\":{\"description\":\"The data types to be exported. To export a snapshot (preview) of the data once a week, choose the data types which contains 'snapshot', other data types will be sent in real-time streaming.\",\"displayName\":\"Exported data types\"}},\"isSecurityFindingsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Security findings are results from vulnerability assessment solutions, and can be thought of as 'sub' recommendations grouped into a 'parent' recommendation.\",\"displayName\":\"Include security findings\"}},\"recommendationNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. To export all recommendations, leave this empty. To export specific recommendations, enter a list of recommendation IDs separated by semicolons (';'). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/assessments.\",\"displayName\":\"Recommendation IDs\"}},\"recommendationSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. Determines recommendation severities. Example: High;Medium;Low;\",\"displayName\":\"Recommendation severities\"}},\"regulatoryComplianceStandardsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of regulatory compliance. To export all regulatory compliance, leave this empty. To export specific regulatory compliance standards, enter a list of these standards names separated by semicolons (';'). Regulatory compliance standards names are available through the regulatory compliance standards API (https://docs.microsoft.com/rest/api/securitycenter/regulatorycompliancestandards), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/regulatorycompliancestandards.\",\"displayName\":\"Regulatory compliance standards names\"}},\"resourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource group location\",\"strongType\":\"location\"}},\"resourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource group name\"}},\"secureScoreControlsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of secure score controls. To export all secure score controls, leave this empty. To export specific secure score controls, enter a list of secure score controls IDs separated by semicolons (';'). Secure score controls IDs are available through the Secure score controls API (https://docs.microsoft.com/rest/api/securitycenter/securescorecontrols), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/securescores/securescorecontrols.\",\"displayName\":\"Secure Score Controls IDs\"}},\"workspaceResourceId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The Log Analytics workspace of where the data should be exported to.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"Microsoft.OperationalInsights/workspaces\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('resourceGroupName')]\",\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"alertSeverities\":{\"value\":\"[parameters('alertSeverities')]\"},\"createResourceGroup\":{\"value\":\"[parameters('createResourceGroup')]\"},\"exportedDataTypes\":{\"value\":\"[parameters('exportedDataTypes')]\"},\"isSecurityFindingsEnabled\":{\"value\":\"[parameters('isSecurityFindingsEnabled')]\"},\"recommendationNames\":{\"value\":\"[parameters('recommendationNames')]\"},\"recommendationSeverities\":{\"value\":\"[parameters('recommendationSeverities')]\"},\"regulatoryComplianceStandardsNames\":{\"value\":\"[parameters('regulatoryComplianceStandardsNames')]\"},\"resourceGroupLocation\":{\"value\":\"[parameters('resourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('resourceGroupName')]\"},\"secureScoreControlsNames\":{\"value\":\"[parameters('secureScoreControlsNames')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('workspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"alertSeverities\":{\"type\":\"array\"},\"createResourceGroup\":{\"type\":\"bool\"},\"exportedDataTypes\":{\"type\":\"array\"},\"guidValue\":{\"defaultValue\":\"[newGuid()]\",\"type\":\"string\"},\"isSecurityFindingsEnabled\":{\"type\":\"bool\"},\"recommendationNames\":{\"type\":\"array\"},\"recommendationSeverities\":{\"type\":\"array\"},\"regulatoryComplianceStandardsNames\":{\"type\":\"array\"},\"resourceGroupLocation\":{\"type\":\"string\"},\"resourceGroupName\":{\"type\":\"string\"},\"secureScoreControlsNames\":{\"type\":\"array\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"condition\":\"[parameters('createResourceGroup')]\",\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('resourceGroupName'))]\"],\"name\":\"[concat('nestedAutomationDeployment', '_', parameters('guidValue'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-01-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"ExportToWorkspace\",\"properties\":{\"actions\":[{\"actionType\":\"Workspace\",\"workspaceResourceId\":\"[parameters('workspaceResourceId')]\"}],\"description\":\"Export Microsoft Defender for Cloud data to Log Analytics workspace via policy\",\"isEnabled\":true,\"scopes\":[{\"description\":\"[replace(variables('scopeDescription'),'{0}', subscription().subscriptionId)]\",\"scopePath\":\"[subscription().id]\"}],\"sources\":\"[variables('sources')]\"},\"tags\":{},\"type\":\"Microsoft.Security/automations\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"alertSeveritiesLength\":\"[length(parameters('alertSeverities'))]\",\"alertSeveritiesLengthIfEmpty\":\"[if(equals(variables('alertSeveritiesLength'), 0), 1, variables('alertSeveritiesLength'))]\",\"alertSeverityMap\":{\"High\":\"high\",\"Low\":\"low\",\"Medium\":\"medium\"},\"customRuleSetsForRegulatoryComplianceObj\":{\"copy\":[{\"count\":\"[variables('regulatoryComplianceStandardsNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), parameters('regulatoryComplianceStandardsNames')[copyIndex('ruleSetsForRegulatoryCompliancArr')])]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForRegulatoryCompliancArr\"}]},\"customRuleSetsForSecureScoreControlsObj\":{\"copy\":[{\"count\":\"[variables('secureScoreControlsLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), parameters('secureScoreControlsNames')[copyIndex('ruleSetsForSecureScoreControlsArr')])]\",\"operator\":\"Equals\",\"propertyJPath\":\"name\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSecureScoreControlsArr\"}]},\"customRuleSetsForSubAssessmentsObj\":{\"copy\":[{\"count\":\"[variables('recommendationNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), replace(variables('subAssessmentRuleExpectedValue'),'{0}', parameters('recommendationNames')[copyIndex('ruleSetsForSubAssessmentsArr')]))]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSubAssessmentsArr\"}]},\"dataTypeMap\":{\"Overall secure score\":\"SecureScores\",\"Overall secure score - snapshot\":\"SecureScoresSnapshot\",\"Regulatory compliance\":\"RegulatoryComplianceAssessment\",\"Regulatory compliance - snapshot\":\"RegulatoryComplianceAssessmentSnapshot\",\"Secure score controls\":\"SecureScoreControls\",\"Secure score controls - snapshot\":\"SecureScoreControlsSnapshot\",\"Security alerts\":\"Alerts\",\"Security findings - snapshot\":\"SubAssessmentsSnapshot\",\"Security recommendations\":\"Assessments\",\"Security recommendations - snapshot\":\"AssessmentsSnapshot\"},\"exportedDataTypesLength\":\"[length(parameters('exportedDataTypes'))]\",\"exportedDataTypesLengthIfEmpty\":\"[if(equals(variables('exportedDataTypesLength'), 0), 1, variables('exportedDataTypesLength'))]\",\"recommendationNamesLength\":\"[length(parameters('recommendationNames'))]\",\"recommendationNamesLengthIfEmpty\":\"[if(equals(variables('recommendationNamesLength'), 0), 1, variables('recommendationNamesLength'))]\",\"recommendationSeveritiesLength\":\"[length(parameters('recommendationSeverities'))]\",\"recommendationSeveritiesLengthIfEmpty\":\"[if(equals(variables('recommendationSeveritiesLength'), 0), 1, variables('recommendationSeveritiesLength'))]\",\"regulatoryComplianceStandardsNamesLength\":\"[length(parameters('regulatoryComplianceStandardsNames'))]\",\"regulatoryComplianceStandardsNamesLengthIfEmpty\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), 1, variables('regulatoryComplianceStandardsNamesLength'))]\",\"ruleSetsForAlertsObj\":{\"copy\":[{\"count\":\"[variables('alertSeveritiesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[variables('alertSeverityMap')[parameters('alertSeverities')[mod(copyIndex('ruleSetsForAlertsArr'),variables('alertSeveritiesLengthIfEmpty'))]]]\",\"operator\":\"Equals\",\"propertyJPath\":\"Severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAlertsArr\"}]},\"ruleSetsForAssessmentsObj\":{\"copy\":[{\"count\":\"[mul(variables('recommendationNamesLengthIfEmpty'),variables('recommendationSeveritiesLengthIfEmpty'))]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'),0),'Microsoft.Security/assessments',parameters('recommendationNames')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationName')),variables('recommendationNamesLength'))])]\",\"operator\":\"Contains\",\"propertyJPath\":\"[if(equals(variables('recommendationNamesLength'),0),'type','name')]\",\"propertyType\":\"string\"},{\"expectedValue\":\"[parameters('recommendationSeverities')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationSeverity')),variables('recommendationSeveritiesLength'))]]\",\"operator\":\"Equals\",\"propertyJPath\":\"properties.metadata.severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAssessmentsArr\"}]},\"ruleSetsForSecureRegulatoryComplianceObj\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), variables('customRuleSetsForRegulatoryComplianceObj').ruleSetsForRegulatoryCompliancArr)]\",\"ruleSetsForSecureScoreControlsObj\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), variables('customRuleSetsForSecureScoreControlsObj').ruleSetsForSecureScoreControlsArr)]\",\"ruleSetsForSubAssessmentsObj\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), variables('customRuleSetsForSubAssessmentsObj').ruleSetsForSubAssessmentsArr)]\",\"ruleSetsMap\":{\"Overall secure score\":null,\"Overall secure score - snapshot\":null,\"Regulatory compliance\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Regulatory compliance - snapshot\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Secure score controls\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Secure score controls - snapshot\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Security alerts\":\"[variables('ruleSetsForAlertsObj').ruleSetsForAlertsArr]\",\"Security findings - snapshot\":\"[variables('ruleSetsForSubAssessmentsObj')]\",\"Security recommendations\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\",\"Security recommendations - snapshot\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\"},\"scopeDescription\":\"scope for subscription {0}\",\"secureScoreControlsLengthIfEmpty\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), 1, variables('secureScoreControlsNamesLength'))]\",\"secureScoreControlsNamesLength\":\"[length(parameters('secureScoreControlsNames'))]\",\"sources\":\"[if(equals(parameters('isSecurityFindingsEnabled'),bool('true')),variables('sourcesWithSubAssessments'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithSubAssessments\":\"[concat(variables('subAssessmentSource'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithoutSubAssessments\":{\"copy\":[{\"count\":\"[variables('exportedDataTypesLengthIfEmpty')]\",\"input\":{\"eventSource\":\"[variables('dataTypeMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\",\"ruleSets\":\"[variables('ruleSetsMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\"},\"name\":\"sources\"}]},\"subAssessmentRuleExpectedValue\":\"/assessments/{0}/\",\"subAssessmentSource\":[{\"eventSource\":\"SubAssessments\",\"ruleSets\":\"[variables('ruleSetsForSubAssessmentsObj')]\"}],\"totalRuleCombinationsForOneRecommendationName\":\"[variables('recommendationSeveritiesLengthIfEmpty')]\",\"totalRuleCombinationsForOneRecommendationSeverity\":1}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":true,\"field\":\"Microsoft.Security/automations/isEnabled\"},{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\"},\"equals\":\"[if(parameters('isSecurityFindingsEnabled'),add(length(parameters('exportedDataTypes')),1),length(parameters('exportedDataTypes')))]\"},{\"count\":{\"name\":\"dataType\",\"value\":\"[parameters('exportedDataTypes')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Assessments\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"Alerts\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security alerts\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScores\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControls\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessment\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoresSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControlsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessmentSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"AssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SubAssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security findings - snapshot\",\"value\":\"[current('dataType')]\"}]}]}},\"equals\":1}},\"equals\":\"[length(parameters('exportedDataTypes'))]\"}]},\"existenceScope\":\"resourcegroup\",\"name\":\"ExportToWorkspace\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Security/automations\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_set_definition",
      "name": "external_lookup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMs with Azure Monitoring Agent(AMA)",
            "display_name": "Legacy - Enable Azure Monitor for VMs",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "55f3eceb-5573-4f18-9695-226972c6d74a",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VM_Deploy\"},{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMSS with Azure Monitoring Agent(AMA). Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Legacy - Enable Azure Monitor for Virtual Machine Scale Sets",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.2\"}",
            "name": "75714362-cae7-409e-9b99-a8e5075b7fad",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_VMSS_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_VMSS_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_VMSS_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_VMSS_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_automation_account",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.Automation/automationAccounts/tf-ds-caf-automation",
          "schema_version": 0,
          "attributes": {
            "dsc_primary_access_key": "g9PZfWpLEW6KwhF1F8ZJ0r8Qu8Q6CQhRNBcxBTNPP4zUFOFTlvdAYcM1uPgwei1czD+FxnLAXjJOIkXq7CPZrw==",
            "dsc_secondary_access_key": "6vZGIBATvhj9d20NGJ9b3tIRNKqq+/TOQ2u0r4GA/X2nP3LSVMqCJJS3DP8enK6JWP9JW9C08DaSrnu2OQ5Lqw==",
            "dsc_server_endpoint": "https://f9bdee6f-aa10-4202-9bc6-31d1bb765a63.agentsvc.cus.azure-automation.net/accounts/f9bdee6f-aa10-4202-9bc6-31d1bb765a63",
            "encryption": [
              {
                "key_source": "Microsoft.Automation",
                "key_vault_key_id": "",
                "user_assigned_identity_id": ""
              }
            ],
            "hybrid_service_url": "https://f9bdee6f-aa10-4202-9bc6-31d1bb765a63.jrds.cus.azure-automation.net/automationAccounts/f9bdee6f-aa10-4202-9bc6-31d1bb765a63",
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.Automation/automationAccounts/tf-ds-caf-automation",
            "identity": [],
            "local_authentication_enabled": true,
            "location": "centralus",
            "name": "tf-ds-caf-automation",
            "private_endpoint_connection": [],
            "public_network_access_enabled": true,
            "resource_group_name": "tf-ds-caf-mgmt",
            "sku_name": "Basic",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/firewallPolicies/tf-ds-caf-fw-centralus-policy",
          "schema_version": 0,
          "attributes": {
            "auto_learn_private_ranges_enabled": false,
            "base_policy_id": "",
            "child_policies": [],
            "dns": [
              {
                "proxy_enabled": true,
                "servers": null
              }
            ],
            "explicit_proxy": [],
            "firewalls": [],
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/firewallPolicies/tf-ds-caf-fw-centralus-policy",
            "identity": [],
            "insights": [],
            "intrusion_detection": [],
            "location": "centralus",
            "name": "tf-ds-caf-fw-centralus-policy",
            "private_ip_ranges": null,
            "resource_group_name": "tf-ds-caf-connectivity-centralus",
            "rule_collection_groups": [],
            "sku": "Standard",
            "sql_redirect_allowed": null,
            "tags": null,
            "threat_intelligence_allowlist": [],
            "threat_intelligence_mode": "Alert",
            "timeouts": null,
            "tls_certificate": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_resource_group.virtual_wan"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_linked_service",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la/linkedServices/Automation",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la/linkedServices/Automation",
            "name": "Automation",
            "read_access_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.Automation/automationAccounts/tf-ds-caf-automation",
            "resource_group_name": "tf-ds-caf-mgmt",
            "timeouts": null,
            "workspace_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la",
            "write_access_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_solution",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/AgentHealthAssessment(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/AgentHealthAssessment(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "AgentHealthAssessment(tf-ds-caf-la)",
                "product": "OMSGallery/AgentHealthAssessment",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "AgentHealthAssessment",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/AntiMalware(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/AntiMalware(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "AntiMalware(tf-ds-caf-la)",
                "product": "OMSGallery/AntiMalware",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "AntiMalware",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/ChangeTracking(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/ChangeTracking(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "ChangeTracking(tf-ds-caf-la)",
                "product": "OMSGallery/ChangeTracking",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "ChangeTracking",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SQLAdvancedThreatProtection(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SQLAdvancedThreatProtection(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "SQLAdvancedThreatProtection(tf-ds-caf-la)",
                "product": "OMSGallery/SQLAdvancedThreatProtection",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "SQLAdvancedThreatProtection",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SQLAssessment(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SQLAssessment(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "SQLAssessment(tf-ds-caf-la)",
                "product": "OMSGallery/SQLAssessment",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "SQLAssessment",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SQLVulnerabilityAssessment(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SQLVulnerabilityAssessment(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "SQLVulnerabilityAssessment(tf-ds-caf-la)",
                "product": "OMSGallery/SQLVulnerabilityAssessment",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "SQLVulnerabilityAssessment",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/Security(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/Security(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "Security(tf-ds-caf-la)",
                "product": "OMSGallery/Security",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "Security",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SecurityInsights(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/SecurityInsights(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "SecurityInsights(tf-ds-caf-la)",
                "product": "OMSGallery/SecurityInsights",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "SecurityInsights",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/ServiceMap(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/ServiceMap(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "ServiceMap(tf-ds-caf-la)",
                "product": "OMSGallery/ServiceMap",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "ServiceMap",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/Updates(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/Updates(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "Updates(tf-ds-caf-la)",
                "product": "OMSGallery/Updates",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "Updates",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/VMInsights(tf-ds-caf-la)",
          "schema_version": 1,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationsManagement/solutions/VMInsights(tf-ds-caf-la)",
            "location": "centralus",
            "plan": [
              {
                "name": "VMInsights(tf-ds-caf-la)",
                "product": "OMSGallery/VMInsights",
                "promotion_code": "",
                "publisher": "Microsoft"
              }
            ],
            "resource_group_name": "tf-ds-caf-mgmt",
            "solution_name": "VMInsights",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_name": "tf-ds-caf-la",
            "workspace_resource_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_automation_account.management",
            "module.enterprise_scale.azurerm_log_analytics_linked_service.management",
            "module.enterprise_scale.azurerm_log_analytics_workspace.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_workspace",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la",
          "schema_version": 2,
          "attributes": {
            "allow_resource_only_permissions": true,
            "cmk_for_query_forced": false,
            "daily_quota_gb": -1,
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la",
            "internet_ingestion_enabled": true,
            "internet_query_enabled": true,
            "location": "centralus",
            "name": "tf-ds-caf-la",
            "primary_shared_key": "KavuOhsU24UCUCAkDfCS34cUlLOgjaONAmX+/ybCaj5TQxLpE2yEeid2NSK3aare9big1G8mfCob+z26VfRTIA==",
            "reservation_capacity_in_gb_per_day": null,
            "resource_group_name": "tf-ds-caf-mgmt",
            "retention_in_days": 30,
            "secondary_shared_key": "4nMQZd+GMmF6i7+vEzyikJCRjrW/JzIuM/+XUMzNsGFxB2XgDpxupvH2pvk/0bAtp0jrgttuglmo3ce+ucmBVw==",
            "sku": "PerGB2018",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_id": "bdb6b39d-dead-4db2-af4b-381473ee5943"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIyIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_resource_group.management"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_1",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
          "schema_version": 0,
          "attributes": {
            "display_name": "Docsquad Terraform ES",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "name": "tf-ds-caf",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/565966d7-2be2-47b1-8a7d-681ca1a8f925",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_2",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-decommissioned",
          "schema_version": 0,
          "attributes": {
            "display_name": "Decommissioned",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-decommissioned",
            "name": "tf-ds-caf-decommissioned",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
          "schema_version": 0,
          "attributes": {
            "display_name": "Landing Zones",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "name": "tf-ds-caf-landing-zones",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-platform",
          "schema_version": 0,
          "attributes": {
            "display_name": "Platform",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-platform",
            "name": "tf-ds-caf-platform",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-sandboxes",
          "schema_version": 0,
          "attributes": {
            "display_name": "Sandboxes",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-sandboxes",
            "name": "tf-ds-caf-sandboxes",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_3",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity",
          "schema_version": 0,
          "attributes": {
            "display_name": "Connectivity",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity",
            "name": "tf-ds-caf-connectivity",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-platform",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
          "schema_version": 0,
          "attributes": {
            "display_name": "Corp",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "name": "tf-ds-caf-corp",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-docsquad-tf",
          "schema_version": 0,
          "attributes": {
            "display_name": "docsquad",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-docsquad-tf",
            "name": "tf-ds-caf-docsquad-tf",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
          "schema_version": 0,
          "attributes": {
            "display_name": "Identity",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "name": "tf-ds-caf-identity",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-platform",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management",
          "schema_version": 0,
          "attributes": {
            "display_name": "Management",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management",
            "name": "tf-ds-caf-management",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-platform",
            "subscription_ids": [
              "659db95c-d840-4ce0-9a6e-68ac0077d8d5"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-online",
          "schema_version": 0,
          "attributes": {
            "display_name": "Online",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-online",
            "name": "tf-ds-caf-online",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-sap",
          "schema_version": 0,
          "attributes": {
            "display_name": "SAP",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-sap",
            "name": "tf-ds-caf-sap",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "019bd241-7ab1-4c2d-9928-7d1f65562a57",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T05:43:04.5148856Z\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T02:17:23.615004Z\"}",
            "name": "Enable-DDoS-VNET",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos/providers/Microsoft.Network/ddosProtectionPlans/tf-ds-caf-ddos-centralus\"},\"effect\":{\"value\":\"Modify\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Pip",
          "schema_version": 0,
          "attributes": {
            "description": "Prevent the deployment of Databricks workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
            "display_name": "Prevent usage of Databricks with public IP",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Pip",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:30:12.3918417Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-DataB-Pip",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Sku",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for AAD.",
            "display_name": "Enforces the use of Premium Databricks workspaces",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Sku",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:30:12.3839662Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-DataB-Sku",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Vnet",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of vnet injection for Databricks workspaces.",
            "display_name": "Enforces the use of vnet injection for Databricks",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Vnet",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:30:12.4768648Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-DataB-Vnet",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-Endpoints",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints.",
            "display_name": "Public network access should be disabled for PaaS services",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-Endpoints",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:56:30.3350842Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Public-Endpoints",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones.",
            "display_name": "Configure Azure PaaS services to use private DNS zones",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "5d9ab15a-cb68-4450-bb45-f3594d04ad60",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T05:43:09.135988Z\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:30:12.9396584Z\"}",
            "name": "Deploy-Private-DNS-Zones",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"azureAcrPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io\"},\"azureAppPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io\"},\"azureAppServicesPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net\"},\"azureAsrPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com\"},\"azureAutomationDSCHybridPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net\"},\"azureAutomationWebhookPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net\"},\"azureBatchPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com\"},\"azureCognitiveSearchPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net\"},\"azureCognitiveServicesPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com\"},\"azureCosmosCassandraPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com\"},\"azureCosmosGremlinPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com\"},\"azureCosmosMongoPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com\"},\"azureCosmosSQLPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com\"},\"azureCosmosTablePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com\"},\"azureDataFactoryPortalPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com\"},\"azureDataFactoryPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net\"},\"azureDiskAccessPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net\"},\"azureEventGridDomainsPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net\"},\"azureEventGridTopicsPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net\"},\"azureEventHubNamespacePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net\"},\"azureFilePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net\"},\"azureHDInsightPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net\"},\"azureIotHubsPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net\"},\"azureIotPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net\"},\"azureKeyVaultPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net\"},\"azureMachineLearningWorkspacePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms\"},\"azureMediaServicesKeyPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net\"},\"azureMediaServicesLivePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net\"},\"azureMediaServicesStreamPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net\"},\"azureMigratePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com\"},\"azureMonitorPrivateDnsZoneId1\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com\"},\"azureMonitorPrivateDnsZoneId2\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com\"},\"azureMonitorPrivateDnsZoneId3\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com\"},\"azureMonitorPrivateDnsZoneId4\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net\"},\"azureMonitorPrivateDnsZoneId5\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net\"},\"azureRedisCachePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net\"},\"azureServiceBusNamespacePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net\"},\"azureSignalRPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net\"},\"azureStorageBlobPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net\"},\"azureStorageBlobSecPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net\"},\"azureStorageDFSPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net\"},\"azureStorageDFSSecPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net\"},\"azureStorageFilePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net\"},\"azureStorageQueuePrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net\"},\"azureStorageQueueSecPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net\"},\"azureStorageStaticWebPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net\"},\"azureStorageStaticWebSecPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net\"},\"azureSynapseDevPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net\"},\"azureSynapseSQLODPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net\"},\"azureSynapseSQLPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net\"},\"azureWebPrivateDnsZoneId\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies creation of Public IPs under the assigned scope.",
            "display_name": "Deny the creation of public IP",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:30:12.4317432Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Public-IP",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"},\"listOfResourceTypesNotAllowed\":{\"value\":[\"Microsoft.Network/publicIPAddresses\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet.",
            "display_name": "RDP access from the Internet should be blocked",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:56:30.0397046Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-RDP-From-Internet",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:52.5971212Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "899e34e9-34de-45fd-80b9-888ee58d9efe",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:58:08.4318513Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Backup",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deployIfNotExists\"},\"exclusionTagName\":{\"value\":\"\"},\"exclusionTagValue\":{\"value\":[]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
            "display_name": "Network interfaces should disable IP forwarding",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:58:07.8975867Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-IP-Forwarding",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster should not allow privileged containers",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:52.6088133Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Priv-Containers-AKS",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should not allow container privilege escalation",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:52.6210301Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Priv-Escalation-AKS",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet.",
            "display_name": "RDP access from the Internet should be blocked",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:56:30.2704671Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-RDP-From-Internet",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
            "display_name": "Secure transfer to storage accounts should be enabled",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:52.5682703Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Storage-http",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:58:07.3823839Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "dc632dc6-1f31-4ec9-ad82-f3c9338740f0",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:58:08.2786332Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AKS-Policy",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing",
          "schema_version": 0,
          "attributes": {
            "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
            "display_name": "Auditing on SQL server should be enabled",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "c4fa3f9e-28c8-4cf0-939f-7ba73e12b9ac",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:56:30.7959169Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-SQL-DB-Auditing",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
          "schema_version": 0,
          "attributes": {
            "description": "This policy ensures that Threat Detection is enabled on SQL Servers.",
            "display_name": "Deploy Threat Detection on SQL servers",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "d75bf7c3-7877-41d6-906c-7e689f77634f",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:56:30.3052821Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-SQL-Threat",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "839b877e-0a0b-40c4-b824-2027d76c046e",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:53.0994996Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Backup",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "06adc35d-4674-43dc-ad3c-54831ea057df",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:58:08.2468499Z\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T02:17:23.6165599Z\"}",
            "name": "Enable-DDoS-VNET",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos/providers/Microsoft.Network/ddosProtectionPlans/tf-ds-caf-ddos-centralus\"},\"effect\":{\"value\":\"Modify\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:56:29.6941742Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-AKS-HTTPS",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
          "schema_version": 0,
          "attributes": {
            "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing exsistense condition require then the combination of Audit.",
            "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "23b42206-2ef5-4cdd-9d82-3b74cfff455d",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:53.1511991Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-TLS-SSL",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy-Log-Analytics.",
            "display_name": "Deploy-Log-Analytics",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "153529cd-c538-4875-baa9-794b67309e1f",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:54:53.1242311Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-Log-Analytics",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"automationAccountName\":{\"value\":\"tf-ds-caf-automation\"},\"automationRegion\":{\"value\":\"centralus\"},\"dataRetention\":{\"value\":\"30\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"rgName\":{\"value\":\"tf-ds-caf-mgmt\"},\"sku\":{\"value\":\"pergb2018\"},\"workspaceName\":{\"value\":\"tf-ds-caf-la\"},\"workspaceRegion\":{\"value\":\"centralus\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Cloud Security Benchmark policy initiative.",
            "display_name": "Microsoft Cloud Security Benchmark",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
            "identity": [],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:58:08.6457388Z\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:30:12.9959234Z\"}",
            "name": "Deploy-ASC-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
          "schema_version": 0,
          "attributes": {
            "description": "Ensures that Activity Log Diagnostics settings are set to push logs into Log Analytics workspace.",
            "display_name": "Deploy Diagnostic Settings for Activity Log to Log Analytics workspace",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "8e237346-4385-4c10-b7c9-69227baf8432",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T05:32:08.8681377Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AzActivity-Log",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud and Security Contacts",
            "display_name": "Deploy Microsoft Defender for Cloud configuration",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "53ec45a0-de38-40a3-85fb-3dea49acf11b",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:30:12.8954473Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-MDFC-Config",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"ascExportResourceGroupLocation\":{\"value\":\"centralus\"},\"ascExportResourceGroupName\":{\"value\":\"tf-ds-caf-asc-export\"},\"emailSecurityContact\":{\"value\":\"vmazo@brighthealthgroup.com\"},\"enableAscForAppServices\":{\"value\":\"DeployIfNotExists\"},\"enableAscForArm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForContainers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForDns\":{\"value\":\"DeployIfNotExists\"},\"enableAscForKeyVault\":{\"value\":\"DeployIfNotExists\"},\"enableAscForOssDb\":{\"value\":\"DeployIfNotExists\"},\"enableAscForServers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSql\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSqlOnVm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForStorage\":{\"value\":\"DeployIfNotExists\"},\"logAnalytics\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
          "schema_version": 0,
          "attributes": {
            "description": "Ensures that Azure resources are configured to forward diagnostic logs and metrics to an Azure Log Analytics workspace.",
            "display_name": "Deploy-Resource-Diag",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "ffa21e53-b57b-463d-8ab0-7564f28e5eba",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T05:32:08.97806Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-Resource-Diag",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
            "display_name": "Enable Azure Monitor for VMs",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "231ea7d5-704d-4ec7-b65a-3da341c7cc07",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T05:32:08.497032Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Enable Azure Monitor for Virtual Machine Scale Sets",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "e4c9aa13-d36f-4b02-9258-ad8e5c7ab00c",
                "tenant_id": "565966d7-2be2-47b1-8a7d-681ca1a8f925",
                "type": "SystemAssigned"
              }
            ],
            "location": "centralus",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T05:32:08.884764Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VMSS-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt/providers/Microsoft.OperationalInsights/workspaces/tf-ds-caf-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_network_ddos_protection_plan",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos/providers/Microsoft.Network/ddosProtectionPlans/tf-ds-caf-ddos-centralus",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos/providers/Microsoft.Network/ddosProtectionPlans/tf-ds-caf-ddos-centralus",
            "location": "centralus",
            "name": "tf-ds-caf-ddos-centralus",
            "resource_group_name": "tf-ds-caf-ddos",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_ids": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
          "schema_version": 0,
          "attributes": {
            "description": "Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
            "display_name": "AppService append enable https only setting to enforce https setting.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:04.1479229Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:17.2993986Z\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Append-AppService-httpsonly",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"notequals\":true}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"value\":true}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.",
            "display_name": "AppService append sites with minimum TLS version to enforce.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.6318788Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:12:51.367453Z\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Append-AppService-latestTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"Select version minimum TLS Web App config\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites/config\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"notEquals\":\"[parameters('minTlsVersion')]\"}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"value\":\"[parameters('minTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.",
            "display_name": "KeyVault SoftDelete should be enabled",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Key Vault\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:07.1188059Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:20.1083241Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-KV-SoftDelete",
            "parameters": "",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"notEquals\":true}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"value\":true}],\"effect\":\"append\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:16.7755183Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:44.0903454Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-Redis-disableNonSslPort",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\",\"Modify\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\",\"value\":false}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.2890864Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.2125274Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-Redis-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Cache for Redis to enforce\",\"displayName\":\"Select version for Redis server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"value\":\"[parameters('minimumTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
          "schema_version": 0,
          "attributes": {
            "description": "Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.",
            "display_name": "Control private endpoint connections to Azure Machine Learning",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:50:46.8703735Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:14.9298514Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Audit-MachineLearning-PrivateEndpointId",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections\",\"field\":\"type\"},{\"equals\":\"Approved\",\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id\"},{\"notEquals\":\"[subscription().subscriptionId]\",\"value\":\"[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of child resources on the Automation Account",
            "display_name": "No child resources in Automation Account",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureUSGovernment\"],\"category\":\"Automation\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.3228849Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:16.7941123Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AA-child-resources",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Automation/automationAccounts/runbooks\",\"Microsoft.Automation/automationAccounts/variables\",\"Microsoft.Automation/automationAccounts/modules\",\"Microsoft.Automation/automationAccounts/credentials\",\"Microsoft.Automation/automationAccounts/connections\",\"Microsoft.Automation/automationAccounts/certificates\"]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to restrict that Application Gateways is always deployed with WAF enabled",
            "display_name": "Application Gateway should be deployed with WAF enabled",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:32.9132305Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:19.4384788Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppGW-Without-WAF",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/applicationGateways/sku.name\",\"notequals\":\"WAF_v2\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "API App should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.2902138Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:47.3154335Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceApiApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Function App should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.482704Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:49.0422669Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceFunctionApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"functionapp*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Web Application should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:09.9503996Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.2711089Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceWebApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"app*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
          "schema_version": 0,
          "attributes": {
            "description": "Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
            "display_name": "Deny public IPs for Databricks cluster",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:16.7892963Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:28.1532633Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-NoPublicIp",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for AAD.",
            "display_name": "Deny non-premium Databricks sku",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:04.0333364Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:18.8035899Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-Sku",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/sku.name\",\"notEquals\":\"premium\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of vnet injection for Databricks workspaces.",
            "display_name": "Deny Databricks workspaces without Vnet injection",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:05.1561289Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:45.6531141Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-VirtualNetwork",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
          "schema_version": 0,
          "attributes": {
            "description": "Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.",
            "display_name": "Deny AKS cluster creation in Azure Machine Learning",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:45.4507561Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:09.6612401Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Aks",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AKS\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/resourceId\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.",
            "display_name": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:41.5399957Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:11.5946599Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Compute-SubnetId",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
          "schema_version": 0,
          "attributes": {
            "description": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.",
            "display_name": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Budget\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:38.5166226Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:12:51.3411607Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Compute-VmSize",
            "parameters": "{\"allowedVmSizes\":{\"type\":\"Array\",\"defaultValue\":[\"Standard_D1_v2\",\"Standard_D2_v2\",\"Standard_D3_v2\",\"Standard_D4_v2\",\"Standard_D11_v2\",\"Standard_D12_v2\",\"Standard_D13_v2\",\"Standard_D14_v2\",\"Standard_DS1_v2\",\"Standard_DS2_v2\",\"Standard_DS3_v2\",\"Standard_DS4_v2\",\"Standard_DS5_v2\",\"Standard_DS11_v2\",\"Standard_DS12_v2\",\"Standard_DS13_v2\",\"Standard_DS14_v2\",\"Standard_M8-2ms\",\"Standard_M8-4ms\",\"Standard_M8ms\",\"Standard_M16-4ms\",\"Standard_M16-8ms\",\"Standard_M16ms\",\"Standard_M32-8ms\",\"Standard_M32-16ms\",\"Standard_M32ls\",\"Standard_M32ms\",\"Standard_M32ts\",\"Standard_M64-16ms\",\"Standard_M64-32ms\",\"Standard_M64ls\",\"Standard_M64ms\",\"Standard_M64s\",\"Standard_M128-32ms\",\"Standard_M128-64ms\",\"Standard_M128ms\",\"Standard_M128s\",\"Standard_M64\",\"Standard_M64m\",\"Standard_M128\",\"Standard_M128m\",\"Standard_D1\",\"Standard_D2\",\"Standard_D3\",\"Standard_D4\",\"Standard_D11\",\"Standard_D12\",\"Standard_D13\",\"Standard_D14\",\"Standard_DS15_v2\",\"Standard_NV6\",\"Standard_NV12\",\"Standard_NV24\",\"Standard_F2s_v2\",\"Standard_F4s_v2\",\"Standard_F8s_v2\",\"Standard_F16s_v2\",\"Standard_F32s_v2\",\"Standard_F64s_v2\",\"Standard_F72s_v2\",\"Standard_NC6s_v3\",\"Standard_NC12s_v3\",\"Standard_NC24rs_v3\",\"Standard_NC24s_v3\",\"Standard_NC6\",\"Standard_NC12\",\"Standard_NC24\",\"Standard_NC24r\",\"Standard_ND6s\",\"Standard_ND12s\",\"Standard_ND24rs\",\"Standard_ND24s\",\"Standard_NC6s_v2\",\"Standard_NC12s_v2\",\"Standard_NC24rs_v2\",\"Standard_NC24s_v2\",\"Standard_ND40rs_v2\",\"Standard_NV12s_v3\",\"Standard_NV24s_v3\",\"Standard_NV48s_v3\"],\"metadata\":{\"description\":\"Specifies the allowed VM Sizes for Aml Compute Clusters and Instances\",\"displayName\":\"Allowed VM Sizes for Aml Compute Clusters and Instances\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/vmSize\",\"notIn\":\"[parameters('allowedVmSizes')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
          "schema_version": 0,
          "attributes": {
            "description": "Deny public access of Azure Machine Learning clusters via SSH.",
            "display_name": "Deny public access of Azure Machine Learning clusters via SSH",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.2525516Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:28.198495Z\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce scale settings for Azure Machine Learning compute clusters.",
            "display_name": "Enforce scale settings for Azure Machine Learning compute clusters",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Budget\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.2706Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:40.3766267Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-ComputeCluster-Scale",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"maxNodeCount\":{\"type\":\"Integer\",\"defaultValue\":10,\"metadata\":{\"description\":\"Specifies the maximum node count of AML Clusters\",\"displayName\":\"Maximum Node Count\"}},\"maxNodeIdleTimeInSecondsBeforeScaleDown\":{\"type\":\"Integer\",\"defaultValue\":900,\"metadata\":{\"description\":\"Specifies the maximum node idle time in seconds before scaledown\",\"displayName\":\"Maximum Node Idle Time in Seconds Before Scaledown\"}},\"minNodeCount\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"Specifies the minimum node count of AML Clusters\",\"displayName\":\"Minimum Node Count\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount\",\"greater\":\"[parameters('maxNodeCount')]\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount\",\"greater\":\"[parameters('minNodeCount')]\"},{\"greater\":\"[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]\",\"value\":\"[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces high business impact Azure Machine Learning workspaces.",
            "display_name": "Enforces high business impact Azure Machine Learning Workspaces",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:41.3286413Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:46.6476899Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-HbiWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
          "schema_version": 0,
          "attributes": {
            "description": "Deny public access behind vnet to Azure Machine Learning workspaces.",
            "display_name": "Deny public acces behind vnet to Azure Machine Learning workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:04.5134586Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:09.5089004Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\"notEquals\":false}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
          "schema_version": 0,
          "attributes": {
            "description": "Denies public network access for Azure Machine Learning workspaces.",
            "display_name": "Azure Machine Learning should have disabled public network access",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:44.9546124Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:15:54.0718054Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-PublicNetworkAccess",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "MySQL database servers enforce SSL connections.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:42.0905672Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:44.7370757Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MySql-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "PostgreSQL database servers enforce SSL connection.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:40.6558195Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:12.7950787Z\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Deny-PostgreSql-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
            "display_name": "Deny the creation of private DNS",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:33.0119054Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:43.1387779Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Private-DNS-Zones",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of Maria DB accounts with exposed public endpoints",
            "display_name": "Public network access should be disabled for MariaDB",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:50:48.1966141Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:28.0320544Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-PublicEndpoint-MariaDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\"notequals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
          "schema_version": 0,
          "attributes": {
            "description": "[Deprecated] This policy denies creation of Public IPs under the assigned scope.",
            "display_name": "[Deprecated] Deny the creation of public IP",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:04.481617Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:25.4962072Z\",\"version\":\"1.0.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deny-PublicIP",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet",
            "display_name": "RDP access from the Internet should be blocked",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:07.3592901Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:37.7712332Z\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-RDP-From-Internet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"3389\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]\"}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"3389\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Azure Cache for Redis only secure connections should be enabled",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:12.9405009Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:06:46.2845911Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Redis-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select minimum TLS version for Azure Cache for Redis.\",\"displayName\":\"Select minumum TLS version for Azure Cache for Redis.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"},{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
            "display_name": "Azure SQL Database should have the minimal TLS version set to the highest version",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:42.0970605Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:09.7849586Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Sql-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
            "display_name": "SQL Managed Instance should have the minimal TLS version set to the highest version",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:10.6031657Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:41.2584791Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-SqlMi-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Storage Account set to minimum TLS and Secure transfer should be enabled",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:38.6743417Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:18.1941884Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Storage-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-04-01\",\"value\":\"[requestContext().apiVersion]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]},{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.",
            "display_name": "Subnets should have a Network Security Group",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:10.355705Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:41.5636957Z\",\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Nsg",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a User Defined Route (UDR).",
            "display_name": "Subnets should have a User Defined Route",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:10.1595189Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.3234617Z\",\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Udr",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].routeTable.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/routeTable.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.",
            "display_name": "Deny vNet peering cross subscription.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.8069962Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:09.7783439Z\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deny-VNET-Peer-Cross-Sub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"notcontains\":\"[subscription().id]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.",
            "display_name": "Deny vNet peering to non-approved vNets",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:11:40.9646194Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-VNET-Peering-To-Non-Approved-VNETs",
            "parameters": "{\"allowedVnets\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}\",\"displayName\":\"Allowed vNets to peer with\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}},{\"not\":{\"exists\":false,\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\"}}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings under the assigned scope.",
            "display_name": "Deny vNet peering ",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:45.2742199Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:14.4945473Z\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deny-VNet-Peering",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud Security Contacts",
            "display_name": "Deploy Microsoft Defender for Cloud Security Contacts",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:10.0851873Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:22.8471187Z\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-ASC-SecurityContacts",
            "parameters": "{\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Azure Security Center contact details\",\"displayName\":\"Security contacts email address\"}},\"minimalSeverity\":{\"type\":\"string\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailSecurityContact\":{\"metadata\":{\"description\":\"Security contacts email address\"},\"type\":\"string\"},\"minimalSeverity\":{\"metadata\":{\"description\":\"Minimal severity level reported\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-01-01-preview\",\"name\":\"default\",\"properties\":{\"alertNotifications\":{\"minimalSeverity\":\"[parameters('minimalSeverity')]\",\"state\":\"On\"},\"emails\":\"[parameters('emailSecurityContact')]\",\"notificationsByRole\":{\"roles\":[\"Owner\"],\"state\":\"On\"}},\"type\":\"Microsoft.Security/securityContacts\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"contains\":\"[parameters('emailSecurityContact')]\",\"field\":\"Microsoft.Security/securityContacts/email\"},{\"contains\":\"[parameters('minimalSeverity')]\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications.minimalSeverity\"},{\"equals\":\"Microsoft.Security/securityContacts\",\"field\":\"type\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertsToAdmins\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a default budget on all subscriptions under the assigned scope",
            "display_name": "Deploy a default budget on all subscriptions under the assigned scope",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureUSGovernment\"],\"category\":\"Budget\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:06.6776746Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:12.2989091Z\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-Budget",
            "parameters": "{\"amount\":{\"type\":\"String\",\"defaultValue\":\"1000\",\"metadata\":{\"description\":\"The total amount of cost or usage to track with the budget\"}},\"budgetName\":{\"type\":\"String\",\"defaultValue\":\"budget-set-by-policy\",\"metadata\":{\"description\":\"The name for the budget to be created\"}},\"contactEmails\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"contactGroups\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"}},\"contactRoles\":{\"type\":\"Array\",\"defaultValue\":[\"Owner\",\"Contributor\"],\"metadata\":{\"description\":\"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\"}},\"firstThreshold\":{\"type\":\"String\",\"defaultValue\":\"90\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"secondThreshold\":{\"type\":\"String\",\"defaultValue\":\"100\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"timeGrain\":{\"type\":\"String\",\"allowedValues\":[\"Monthly\",\"Quarterly\",\"Annually\",\"BillingMonth\",\"BillingQuarter\",\"BillingAnnual\"],\"defaultValue\":\"Monthly\",\"metadata\":{\"description\":\"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"amount\":{\"value\":\"[parameters('amount')]\"},\"budgetName\":{\"value\":\"[parameters('budgetName')]\"},\"contactEmails\":{\"value\":\"[parameters('contactEmails')]\"},\"contactGroups\":{\"value\":\"[parameters('contactGroups')]\"},\"contactRoles\":{\"value\":\"[parameters('contactRoles')]\"},\"firstThreshold\":{\"value\":\"[parameters('firstThreshold')]\"},\"secondThreshold\":{\"value\":\"[parameters('secondThreshold')]\"},\"timeGrain\":{\"value\":\"[parameters('timeGrain')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"amount\":{\"type\":\"String\"},\"budgetName\":{\"type\":\"String\"},\"contactEmails\":{\"type\":\"Array\"},\"contactGroups\":{\"type\":\"Array\"},\"contactRoles\":{\"type\":\"Array\"},\"firstThreshold\":{\"type\":\"String\"},\"secondThreshold\":{\"type\":\"String\"},\"startDate\":{\"defaultValue\":\"[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\",\"type\":\"String\"},\"timeGrain\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[parameters('budgetName')]\",\"properties\":{\"amount\":\"[parameters('amount')]\",\"category\":\"Cost\",\"notifications\":{\"NotificationForExceededBudget1\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('firstThreshold')]\"},\"NotificationForExceededBudget2\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('secondThreshold')]\"}},\"timeGrain\":\"[parameters('timeGrain')]\",\"timePeriod\":{\"startDate\":\"[parameters('startDate')]\"}},\"type\":\"Microsoft.Consumption/budgets\"}]}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('amount')]\",\"field\":\"Microsoft.Consumption/budgets/amount\"},{\"equals\":\"[parameters('timeGrain')]\",\"field\":\"Microsoft.Consumption/budgets/timeGrain\"},{\"equals\":\"Cost\",\"field\":\"Microsoft.Consumption/budgets/category\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Consumption/budgets\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)",
            "display_name": "Deploy a route table with specific user defined routes",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:17:45.8177369Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Custom-Route-Table",
            "parameters": "{\"disableBgpPropagation\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Disable BGP Propagation\",\"displayName\":\"DisableBgpPropagation\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRoutes\":{\"type\":\"Array\",\"metadata\":{\"description\":\"Routes that must exist in compliant route tables deployed by this policy\",\"displayName\":\"requiredRoutes\"}},\"routeTableName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the route table automatically deployed by this policy\",\"displayName\":\"routeTableName\"}},\"vnetRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Only VNets in this region will be evaluated against this policy\",\"displayName\":\"vnetRegion\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"equals\":\"[parameters('vnetRegion')]\",\"field\":\"location\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"routeTableDepl\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"location\":\"[[parameters('vnetRegion')]\",\"name\":\"[[parameters('routeTableName')]\",\"properties\":{\"copy\":\"[variables('copyLoop')]\",\"disableBgpRoutePropagation\":\"[[parameters('disableBgpPropagation')]\"},\"type\":\"Microsoft.Network/routeTables\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"copyLoop\":[{\"count\":\"[[length(parameters('requiredRoutes'))]\",\"input\":{\"name\":\"[[concat('route-',copyIndex('routes'))]\",\"properties\":{\"addressPrefix\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]\",\"nextHopIpAddress\":\"[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]\",\"nextHopType\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]\"}},\"name\":\"routes\"}]}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('routeTableName')]\",\"field\":\"name\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"in\":\"[parameters('requiredRoutes')]\",\"value\":\"[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]\"}},\"equals\":\"[length(parameters('requiredRoutes'))]\"}]},\"roleDefinitionIds\":[\"/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/routeTables\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys an Azure DDoS Network Protection",
            "display_name": "Deploy an Azure DDoS Network Protection",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:38.8307756Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.2035096Z\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deploy-DDoSProtection",
            "parameters": "{\"ddosName\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet\",\"displayName\":\"ddosName\"}},\"ddosRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet location\",\"displayName\":\"ddosRegion\",\"strongType\":\"location\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"ddosname\":{\"value\":\"[parameters('ddosname')]\"},\"ddosregion\":{\"value\":\"[parameters('ddosRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"ddosRegion\":{\"type\":\"String\"},\"ddosname\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"ddosprotection\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-12-01\",\"location\":\"[parameters('ddosRegion')]\",\"name\":\"[parameters('ddosName')]\",\"properties\":{},\"type\":\"Microsoft.Network/ddosProtectionPlans\"}]}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('ddosName')]\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/ddosProtectionPlans\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Automation to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:32.8436485Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:48.2026023Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AA",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Automation/automationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"JobLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobStreams\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DscNodeStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Automation/automationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.",
            "display_name": "Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:45.1616232Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:47.3294164Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ACI",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerInstance/containerGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.",
            "display_name": "Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:17.1039916Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.7089325Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ACR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ContainerRegistryLoginEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ContainerRegistryRepositoryEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerRegistry/registries/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for API Management to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:45.3244205Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:37.4970739Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-APIMgmt",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"WebSocketConnectionLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ApiManagement/service/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:13:12.9408134Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AVDScalingPlans",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/scalingplans\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:06.8910854Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:41.2409943Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AnalysisService",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.AnalysisServices/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Service\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.AnalysisServices/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:32.840339Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:38.2064308Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ApiForFHIR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HealthcareApis/services/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:37.9999576Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:50.3556858Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ApplicationGateway",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ApplicationGatewayAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayPerformanceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/applicationGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:10:09.5863774Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Bastion",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/bastionHosts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"BastionAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/bastionHosts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:17.1071239Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:49.9349013Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CDNEndpoints",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cdn/profiles/endpoints\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"CoreAnalytics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:39.128291Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:25.4593514Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CognitiveServices",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RequestResponse\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Trace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.CognitiveServices/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:32.8925355Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:50.9537279Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CosmosDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MongoRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyRUConsumption\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ControlPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CassandraRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"GremlinRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"Requests\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.40088Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.1988629Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DLAnalytics",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.2884979Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:22.8818897Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DataExplorerCluster",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Kusto/Clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"SucceededIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FailedIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IngestionBatching\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Command\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Query\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableUsageStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Kusto/Clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.301341Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:15.3891303Z\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DataFactory",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataFactory/factories\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TriggerRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessages\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutableStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessageContext\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionComponentPhases\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionDataStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISIntegrationRuntimeLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SandboxPipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SandboxActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataFactory/factories/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.6712715Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:38.0598632Z\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Databricks",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"dbfs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusters\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"accounts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"jobs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"notebook\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ssh\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"workspace\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"secrets\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlPermissions\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"instancePools\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlanalytics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"genie\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"globalInitScripts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"iamRole\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"mlflowExperiment\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"featureStore\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RemoteHistoryService\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"mlflowAcledArtifact\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"databrickssql\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"deltaPipelines\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"modelRegistry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"repos\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"unityCatalog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"gitCredentials\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"webTerminal\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Databricks/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:10.6255075Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:18.9833285Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridSub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/eventSubscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:33.0083914Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:12.7070159Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridSystemTopic",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/systemTopics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/systemTopics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:09.9640903Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:40.8936061Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridTopic",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/topics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PublishFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/topics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:07.8387749Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.1824788Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ExpressRoute",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/expressRouteCircuits\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PeeringRouteLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:50:48.108658Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:44.3841109Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Firewall",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/azureFirewalls\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AzureFirewallApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallDnsProxy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWThreatIntel\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWIdpsSignature\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWDnsQuery\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFqdnResolveFailure\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFatFlow\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFlowTrace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/azureFirewalls/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:45.3614658Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:49.6499427Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-FrontDoor",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/frontDoors\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FrontdoorAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FrontdoorWebApplicationFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/frontDoors/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.803714Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:17.8222333Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Function",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FunctionAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.7550936Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:12.8241886Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-HDInsight",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HDInsight/clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HDInsight/clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:04.497637Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.7061603Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LoadBalancer",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/loadBalancers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"LoadBalancerAlertEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"LoadBalancerProbeHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/loadBalancers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Log Analytics workspaces to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:17:47.6476254Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"microsoft.operationalinsights/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"microsoft.operationalinsights/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.5716744Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:09:48.8421135Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LogicAppsISE",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/integrationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"IntegrationAccountTrackingEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/integrationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for MariaDB to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:03.9627109Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:09:48.5559835Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MariaDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMariaDB/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:37:04.5058242Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:20.1201184Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MediaService",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Media/mediaServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"KeyDeliveryRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Media/mediaServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:33.6250195Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:13:12.8258554Z\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MlWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AmlComputeClusterEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeClusterNodeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeJobEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeCpuGpuUtilization\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlRunStatusChangedEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsActionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ComputeInstanceEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:09.3196533Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:46.3755706Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MySQL",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMySQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.8028105Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:08.7626428Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-NIC",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkInterfaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:41.7417886Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:15.7523273Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-NetworkSecurityGroups",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"NetworkSecurityGroupEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkSecurityGroupRuleCounter\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:45.0884457Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:48.192697Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-PostgreSQL",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.1478974Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:50.3638571Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-PowerBIEmbedded",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.PowerBIDedicated/capacities\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:07.6517153Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:44.1426621Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-RedisCache",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cache/redis/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Relay to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:44.4708199Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:17.4165302Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Relay",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Relay/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"HybridConnectionsEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Relay/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:17.2599126Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:20:50.3603596Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SQLElasticPools",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/elasticPools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:38.9367602Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:05:35.2115818Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SQLMI",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ResourceUsageStats\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DevOpsOperationsAudit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/managedInstances/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:38:35.6265719Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:18:56.6481583Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SignalR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.SignalRService/SignalR\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AllLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.SignalRService/SignalR/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:42.1132877Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:37.8709063Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-TimeSeriesInsights",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.TimeSeriesInsights/environments\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Ingress\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:43.5611543Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:54.2305093Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-TrafficManager",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/trafficManagerProfiles\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ProbeHealthStatusEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:16.8574025Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:38.0269234Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VM",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:39.0078788Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:22.5811448Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VMSS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
            "display_name": "Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:32.7170284Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:18:56.7346965Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VNetGW",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworkGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"P2SDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.2666037Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.5740703Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VirtualNetwork",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"VMProtectionAlerts\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworks/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:17.9068817Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:15:53.8909834Z\",\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDAppGroup",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/applicationGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:09.8837162Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:06:46.1702692Z\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDHostPools",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/hostpools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Connection\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"HostRegistration\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AgentHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkData\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SessionHostManagement\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:41.8199733Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:11:41.2831656Z\",\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Feed\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.318474Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:18.4802032Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WebServerFarm",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/serverfarms/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for App Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:47:44.831173Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.6873441Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Website",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"notContains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AppServiceAntivirusScanAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceFileAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.2783361Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:47.3424431Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-iotHub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Devices/IotHubs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Connections\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceTelemetry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DCommands\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceIdentityOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FileUploadOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Routes\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"D2CTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TwinQueries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobsOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DirectMethods\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DistributedTracing\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Configurations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceStreams\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Devices/IotHubs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Azure Firewall Manager policy in subscription where the policy is assigned.",
            "display_name": "Deploy Azure Firewall Manager policy in the subscription",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:11.9502602Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:15.9157861Z\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deploy-FirewallPolicy",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"fwPolicyRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for Azure Firewall Policy\",\"displayName\":\"fwPolicyRegion\",\"strongType\":\"location\"}},\"fwpolicy\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Object describing Azure Firewall Policy\",\"displayName\":\"fwpolicy\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"fwPolicy\":{\"value\":\"[parameters('fwPolicy')]\"},\"fwPolicyRegion\":{\"value\":\"[parameters('fwPolicyRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"fwPolicy\":{\"type\":\"object\"},\"fwPolicyRegion\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"fwpolicies\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[],\"location\":\"[parameters('fwpolicy').location]\",\"name\":\"[parameters('fwpolicy').firewallPolicyName]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[\"[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]\"],\"name\":\"[parameters('fwpolicy').ruleGroups.name]\",\"properties\":{\"priority\":\"[parameters('fwpolicy').ruleGroups.properties.priority]\",\"rules\":\"[parameters('fwpolicy').ruleGroups.properties.rules]\"},\"type\":\"ruleGroups\"}],\"tags\":{},\"type\":\"Microsoft.Network/firewallPolicies\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/firewallPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:35:33.0119001Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:16.9633339Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-MySQL-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server\",\"displayName\":\"Effect minimum TLS version Azure Database for MySQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforMySQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforMySQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
          "schema_version": 0,
          "attributes": {
            "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to a storageaccountid with a specified retention period.",
            "display_name": "[Deprecated] Deploys NSG flow logs and traffic analytics",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:38.5653072Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:56.8982109Z\",\"version\":\"1.0.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deploy-Nsg-FlowLogs",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"flowAnalyticsEnabled\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"displayName\":\"Enable Traffic Analytics\"}},\"logAnalytics\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"storageAccountResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"Storage Account Resource Id\",\"strongType\":\"Microsoft.Storage/storageAccounts\"}},\"trafficAnalyticsInterval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"flowAnalyticsEnabled\":{\"value\":\"[parameters('flowAnalyticsEnabled')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"networkSecurityGroupName\":{\"value\":\"[field('name')]\"},\"resourceGroupName\":{\"value\":\"[resourceGroup().name]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"storageAccountResourceId\":{\"value\":\"[parameters('storageAccountResourceId')]\"},\"trafficAnalyticsInterval\":{\"value\":\"[parameters('trafficAnalyticsInterval')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"flowAnalyticsEnabled\":{\"type\":\"bool\"},\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"networkSecurityGroupName\":{\"type\":\"String\"},\"resourceGroupName\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"storageAccountResourceId\":{\"type\":\"String\"},\"trafficAnalyticsInterval\":{\"type\":\"int\"}},\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":\"[bool(parameters('flowAnalyticsEnabled'))]\",\"trafficAnalyticsInterval\":\"[parameters('trafficAnalyticsInterval')]\",\"workspaceId\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]\",\"workspaceRegion\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]\",\"workspaceResourceId\":\"[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[parameters('storageAccountResourceId')]\",\"targetResourceId\":\"[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]\"},\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"},{\"equals\":\"[parameters('flowAnalyticsEnabled')]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\"}]},\"resourceGroupName\":\"NetworkWatcherRG\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
          "schema_version": 0,
          "attributes": {
            "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to Log Analytics with a specfied retention period.",
            "display_name": "[Deprecated] Deploys NSG flow logs and traffic analytics to Log Analytics",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:07.2576853Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.5034756Z\",\"version\":\"1.1.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deploy-Nsg-FlowLogs-to-LA",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"interval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"workspace\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"interval\":{\"value\":\"[parameters('interval')]\"},\"location\":{\"value\":\"[field('location')]\"},\"networkSecurityGroup\":{\"value\":\"[field('id')]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"workspace\":{\"value\":\"[parameters('workspace')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"interval\":{\"type\":\"int\"},\"location\":{\"type\":\"String\"},\"networkSecurityGroup\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"time\":{\"defaultValue\":\"[utcNow()]\",\"type\":\"String\"},\"workspace\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2019-06-01\",\"kind\":\"StorageV2\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('storageAccountName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard_LRS\",\"tier\":\"Standard\"},\"type\":\"Microsoft.Storage/storageAccounts\"}]}},\"resourceGroup\":\"[variables('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\"],\"name\":\"[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('NetworkWatcher_', toLower(parameters('location')))]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-11-01\",\"dependsOn\":[\"[concat('NetworkWatcher_', toLower(parameters('location')))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('securityGroupName'), '-Network-flowlog')]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":true,\"trafficAnalyticsInterval\":\"[parameters('interval')]\",\"workspaceResourceId\":\"[parameters('workspace')]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]\",\"targetResourceId\":\"[parameters('networkSecurityGroup')]\"},\"type\":\"flowLogs\"}],\"type\":\"Microsoft.Network/networkWatchers\"}]}},\"resourceGroup\":\"NetworkWatcherRG\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"resourceGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[4]]\",\"securityGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[8]]\",\"storageAccountName\":\"[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\"resourceGroupName\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12\",\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/networkWatchers/flowlogs\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12",
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab",
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL ",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:41.3599403Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:43.6319878Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-PostgreSQL-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server\",\"displayName\":\"Effect Azure Database for PostgreSQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Database for PostgreSQL server to enforce\",\"displayName\":\"Select version for PostgreSQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notEquals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforPostgreSQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "SQL servers deploys a specific min TLS version requirement.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:16.5050615Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:08:38.1553705Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-SQL-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
            "display_name": "Deploy SQL database auditing settings",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:46:13.5287256Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:16.1077913Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-AuditingSettings",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"auditActionsAndGroups\":[\"BATCH_COMPLETED_GROUP\",\"DATABASE_OBJECT_CHANGE_GROUP\",\"SCHEMA_OBJECT_CHANGE_GROUP\",\"BACKUP_RESTORE_GROUP\",\"APPLICATION_ROLE_CHANGE_PASSWORD_GROUP\",\"DATABASE_PRINCIPAL_CHANGE_GROUP\",\"DATABASE_PRINCIPAL_IMPERSONATION_GROUP\",\"DATABASE_ROLE_MEMBER_CHANGE_GROUP\",\"USER_CHANGE_PASSWORD_GROUP\",\"DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP\",\"DATABASE_OBJECT_PERMISSION_CHANGE_GROUP\",\"DATABASE_PERMISSION_CHANGE_GROUP\",\"SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP\",\"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\",\"FAILED_DATABASE_AUTHENTICATION_GROUP\"],\"isAzureMonitorTargetEnabled\":true,\"state\":\"enabled\"},\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/state\"},{\"equals\":\"true\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled\"}]},\"name\":\"default\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
            "display_name": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:49:17.1238536Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.5646941Z\",\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-SecurityAlertPolicies",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"emailAddresses\":{\"type\":\"Array\",\"defaultValue\":[\"admin@contoso.com\",\"admin@fabrikam.com\"]}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"emailAddresses\":{\"value\":\"[parameters('emailAddresses')]\"},\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailAddresses\":{\"type\":\"Array\"},\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-06-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"disabledAlerts\":[\"\"],\"emailAccountAdmins\":true,\"emailAddresses\":\"[parameters('emailAddresses')]\",\"retentionDays\":0,\"state\":\"Enabled\",\"storageAccountAccessKey\":\"\",\"storageEndpoint\":null},\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/databases/securityAlertPolicies/state\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment",
            "display_name": "Deploy SQL Database Transparent Data Encryption",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:01.299853Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:14:44.6554789Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-Tde",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedDatabases\":{\"type\":\"Array\",\"defaultValue\":[\"master\",\"model\",\"tempdb\",\"msdb\",\"resource\"],\"metadata\":{\"description\":\"Array of databases that are excluded from this policy\",\"displayName\":\"Excluded Databases\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedDatabases')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2014-04-01\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]\",\"properties\":{\"status\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters",
            "display_name": "Deploy SQL Database vulnerability Assessments",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:44:41.3299241Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:10:10.2986131Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-vulnerabilityAssessments",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":[\"[parameters('vulnerabilityAssessmentsEmail')]\"],\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails\"},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
              "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "SQL managed instances deploy a specific min TLS version requirement.",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:40:07.4171551Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:16:15.7380411Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-SqlMi-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-02-02-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/managedInstances\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/managedInstances\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.",
            "display_name": "Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS ",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:34:02.2836365Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:07:06.7947635Z\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Storage-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure STorage\",\"displayName\":\"Effect Azure Storage\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure STorage to enforce\",\"displayName\":\"Select TLS version for Azure Storage server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notEquals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('minimumTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimumTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimumTlsVersion\":\"[parameters('minimumTlsVersion')]\",\"supportsHttpsTrafficOnly\":true},\"type\":\"Microsoft.Storage/storageAccounts\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"equals\":\"[parameters('minimumTlsVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Storage/storageAccounts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys virtual network and peer to the hub",
            "display_name": "Deploy Virtual Network with peering to the hub",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:41:38.9748289Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:17:25.5204009Z\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-VNET-HubSpoke",
            "parameters": "{\"dnsServers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Default domain servers for the vNET.\",\"displayName\":\"DNSServers\"}},\"hubResourceId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Resource ID for the HUB vNet\",\"displayName\":\"hubResourceId\"}},\"vNetCidrRange\":{\"type\":\"String\",\"metadata\":{\"description\":\"CIDR Range for the vNet\",\"displayName\":\"vNetCidrRange\"}},\"vNetLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"Location for the vNet\",\"displayName\":\"vNetLocation\"}},\"vNetName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet\",\"displayName\":\"vNetName\"}},\"vNetPeerUseRemoteGateway\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Enable gateway transit for the LZ network\",\"displayName\":\"vNetPeerUseRemoteGateway\"}},\"vNetRgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet RG\",\"displayName\":\"vNetRgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('vNetRgName')]\",\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"dnsServers\":{\"value\":\"[parameters('dnsServers')]\"},\"hubResourceId\":{\"value\":\"[parameters('hubResourceId')]\"},\"vNetCidrRange\":{\"value\":\"[parameters('vNetCidrRange')]\"},\"vNetLocation\":{\"value\":\"[parameters('vNetLocation')]\"},\"vNetName\":{\"value\":\"[parameters('vNetName')]\"},\"vNetPeerUseRemoteGateway\":{\"value\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"vNetRgName\":{\"value\":\"[parameters('vNetRgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"dnsServers\":{\"defaultValue\":[],\"type\":\"Array\"},\"hubResourceId\":{\"type\":\"String\"},\"vNetCidrRange\":{\"type\":\"String\"},\"vNetLocation\":{\"type\":\"String\"},\"vNetName\":{\"type\":\"String\"},\"vNetPeerUseRemoteGateway\":{\"defaultValue\":false,\"type\":\"bool\"},\"vNetRgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetRgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"}],\"variables\":{}}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\"],\"name\":\"[concat('alz-vnet-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetName')]\",\"properties\":{\"addressSpace\":{\"addressPrefixes\":[\"[parameters('vNetCidrRange')]\"]},\"dhcpOptions\":{\"dnsServers\":\"[parameters('dnsServers')]\"}},\"type\":\"Microsoft.Network/virtualNetworks\"},{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat(parameters('vNetName'), '/peerToHub')]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":false,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[parameters('hubResourceId')]\"},\"useRemoteGateways\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat('alz-hub-peering-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"hubName\":{\"value\":\"[split(parameters('hubResourceId'),'/')[8]]\"},\"remoteVirtualNetwork\":{\"value\":\"[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"hubName\":{\"defaultValue\":false,\"type\":\"String\"},\"remoteVirtualNetwork\":{\"defaultValue\":false,\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"name\":\"[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":true,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[[parameters('remoteVirtualNetwork')]\"},\"useRemoteGateways\":false},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"}],\"variables\":{}}},\"resourceGroup\":\"[split(parameters('hubResourceId'),'/')[4]]\",\"subscriptionId\":\"[split(parameters('hubResourceId'),'/')[2]]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('vNetRgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"field\":\"name\",\"like\":\"[parameters('vNetName')]\"},{\"equals\":\"[parameters('vNetLocation')]\",\"field\":\"location\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('vNetName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/virtualNetworks\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine",
            "display_name": "Deploy Windows Domain Join Extension with keyvault configuration",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Guest Configuration\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:43:10.5396982Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:19:18.6661376Z\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Windows-DomainJoin",
            "parameters": "{\"domainFQDN\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainFQDN\"}},\"domainOUPath\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainOUPath\"}},\"domainPassword\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainPassword\"}},\"domainUsername\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainUsername\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"keyVaultResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"keyVaultResourceId\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2008-R2-SP1-zhcn\",\"2012-Datacenter\",\"2012-datacenter-gensecond\",\"2012-Datacenter-smalldisk\",\"2012-datacenter-smalldisk-g2\",\"2012-Datacenter-zhcn\",\"2012-datacenter-zhcn-g2\",\"2012-R2-Datacenter\",\"2012-r2-datacenter-gensecond\",\"2012-R2-Datacenter-smalldisk\",\"2012-r2-datacenter-smalldisk-g2\",\"2012-R2-Datacenter-zhcn\",\"2012-r2-datacenter-zhcn-g2\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-datacenter-gs\",\"2016-Datacenter-Server-Core\",\"2016-datacenter-server-core-g2\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-datacenter-server-core-smalldisk-g2\",\"2016-Datacenter-smalldisk\",\"2016-datacenter-smalldisk-g2\",\"2016-Datacenter-with-Containers\",\"2016-datacenter-with-containers-g2\",\"2016-Datacenter-with-RDSH\",\"2016-Datacenter-zhcn\",\"2016-datacenter-zhcn-g2\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-datacenter-core-g2\",\"2019-Datacenter-Core-smalldisk\",\"2019-datacenter-core-smalldisk-g2\",\"2019-Datacenter-Core-with-Containers\",\"2019-datacenter-core-with-containers-g2\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-datacenter-core-with-containers-smalldisk-g2\",\"2019-datacenter-gensecond\",\"2019-datacenter-gs\",\"2019-Datacenter-smalldisk\",\"2019-datacenter-smalldisk-g2\",\"2019-Datacenter-with-Containers\",\"2019-datacenter-with-containers-g2\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-datacenter-with-containers-smalldisk-g2\",\"2019-Datacenter-zhcn\",\"2019-datacenter-zhcn-g2\",\"Datacenter-Core-1803-with-Containers-smalldisk\",\"datacenter-core-1803-with-containers-smalldisk-g2\",\"Datacenter-Core-1809-with-Containers-smalldisk\",\"datacenter-core-1809-with-containers-smalldisk-g2\",\"Datacenter-Core-1903-with-Containers-smalldisk\",\"datacenter-core-1903-with-containers-smalldisk-g2\",\"datacenter-core-1909-with-containers-smalldisk\",\"datacenter-core-1909-with-containers-smalldisk-g1\",\"datacenter-core-1909-with-containers-smalldisk-g2\"]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"domainFQDN\":{\"value\":\"[parameters('domainFQDN')]\"},\"domainOUPath\":{\"value\":\"[parameters('domainOUPath')]\"},\"domainPassword\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainPassword')]\"}},\"domainUsername\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainUsername')]\"}},\"keyVaultResourceId\":{\"value\":\"[parameters('keyVaultResourceId')]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"domainFQDN\":{\"type\":\"String\"},\"domainOUPath\":{\"type\":\"String\"},\"domainPassword\":{\"type\":\"securestring\"},\"domainUsername\":{\"type\":\"String\"},\"keyVaultResourceId\":{\"type\":\"String\"},\"location\":{\"type\":\"String\"},\"vmName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2015-06-15\",\"location\":\"[resourceGroup().location]\",\"name\":\"[concat(variables('vmName'),'/joindomain')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"Password\":\"[parameters('domainPassword')]\"},\"publisher\":\"Microsoft.Compute\",\"settings\":{\"Name\":\"[parameters('domainFQDN')]\",\"OUPath\":\"[parameters('domainOUPath')]\",\"Options\":\"[variables('domainJoinOptions')]\",\"Restart\":\"true\",\"User\":\"[parameters('domainUserName')]\"},\"type\":\"JsonADDomainExtension\",\"typeHandlerVersion\":\"1.3\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"domainJoinOptions\":3,\"vmName\":\"[parameters('vmName')]\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"JsonADDomainExtension\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Compute\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_policy_set_definition",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
            "display_name": "Public network access should be disabled for PaaS services",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:52:50.9026512Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:26:05.4055043Z\",\"version\":\"1.0.1\"}",
            "name": "Deny-PublicPaaSEndpoints",
            "parameters": "{\"ACRPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure Container Registires with exposed public endpoints \",\"displayName\":\"Public network access on Azure Container Registry disabled\"}},\"AFSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure File Sync instances with exposed public endpoints \",\"displayName\":\"Public network access on Azure File Sync disabled\"}},\"AKSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies  the creation of  Azure Kubernetes Service non-private clusters\",\"displayName\":\"Public network access on AKS API should be disabled\"}},\"BatchPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Batch Instances with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Batch Instances\"}},\"CosmosPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies that  Cosmos database accounts  are created with out public network access is disabled.\",\"displayName\":\"Public network access should be disabled for CosmosDB\"}},\"KeyVaultPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access should be disabled for KeyVault\"}},\"MySQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for MySQL Flexible Server\"}},\"PostgreSQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Postgre SQL Flexible DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for PostgreSql Flexible Server\"}},\"SqlServerPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Sql servers with exposed public endpoints\",\"displayName\":\"Public network access on Azure SQL Database should be disabled\"}},\"StoragePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access onStorage accounts should be disabled\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                "policy_group_names": [],
                "reference_id": "CosmosDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                "policy_group_names": [],
                "reference_id": "KeyVaultDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                "policy_group_names": [],
                "reference_id": "SqlServerDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StoragePublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                "policy_group_names": [],
                "reference_id": "StorageDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                "policy_group_names": [],
                "reference_id": "AKSDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                "policy_group_names": [],
                "reference_id": "ACRDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AFSPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                "policy_group_names": [],
                "reference_id": "AFSDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLFlexPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                "policy_group_names": [],
                "reference_id": "PostgreSQLFlexDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLFlexPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                "policy_group_names": [],
                "reference_id": "MySQLFlexDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                "policy_group_names": [],
                "reference_id": "BatchDenyPublicIP"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. See the list of policies of the services that are included ",
            "display_name": "Deploy Diagnostic Settings to Azure Services",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Monitoring\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:52:50.4687217Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:26:05.4667122Z\",\"version\":\"2.0.0\"}",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "parameters": "{\"ACILogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Instances to Log Analytics workspace\"}},\"ACRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Registry to Log Analytics workspace\"}},\"AKSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace\"}},\"APIMgmtLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for API Management to Log Analytics workspace\"}},\"APIforFHIRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace\"}},\"AVDScalingPlansLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace\"}},\"AnalysisServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace\"}},\"AppServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace\"}},\"AppServiceWebappLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service to Log Analytics workspace\"}},\"ApplicationGatewayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace\"}},\"AutomationLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Automation to Log Analytics workspace\"}},\"BastionLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace\"}},\"BatchLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Batch to Log Analytics workspace\"}},\"CDNEndpointsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace\"}},\"CognitiveServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace\"}},\"CosmosLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace\"}},\"DataExplorerClusterLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace\"}},\"DataFactoryLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Factory to Log Analytics workspace\"}},\"DataLakeAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\"}},\"DataLakeStoreLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace\"}},\"DatabricksLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Databricks to Log Analytics workspace\"}},\"EventGridSubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace\"}},\"EventGridTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace\"}},\"EventHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace\"}},\"EventSystemTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace\"}},\"ExpressRouteLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace\"}},\"FirewallLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Firewall to Log Analytics workspace\"}},\"FrontDoorLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Front Door to Log Analytics workspace\"}},\"FunctionAppLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace\"}},\"HDInsightLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for HDInsight to Log Analytics workspace\"}},\"IotHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace\"}},\"KeyVaultLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Key Vault to Log Analytics workspace\"}},\"LoadBalancerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace\"}},\"LogAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Log Analytics to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category Audit enabled\",\"displayName\":\"Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace\"}},\"LogicAppsISELogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace\"}},\"LogicAppsWFLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace\"}},\"MariaDBLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for MariaDB to Log Analytics workspace\"}},\"MediaServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace\"}},\"MlWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace\"}},\"MySQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace\"}},\"NetworkNICLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace\"}},\"NetworkPublicIPNicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace\"}},\"NetworkSecurityGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace\"}},\"PostgreSQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace\"}},\"PowerBIEmbeddedLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace\"}},\"RedisCacheLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace\"}},\"RelayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Relay to Log Analytics workspace\"}},\"SQLDBsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace\"}},\"SQLElasticPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace\"}},\"SQLMLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace\"}},\"SearchServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\"}},\"ServiceBusLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace\"}},\"SignalRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SignalR to Log Analytics workspace\"}},\"StorageAccountsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace\"}},\"StreamAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\"}},\"TimeSeriesInsightsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace\"}},\"TrafficManagerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace\"}},\"VMSSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace\"}},\"VNetGWLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace\"}},\"VirtualMachinesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace\"}},\"VirtualNetworkLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace\"}},\"WVDAppGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace\"}},\"WVDHostPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace\"}},\"WVDWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
                "policy_group_names": [],
                "reference_id": "StorageAccountDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
                "policy_group_names": [],
                "reference_id": "StorageAccountBlobServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
                "policy_group_names": [],
                "reference_id": "StorageAccountFileServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
                "policy_group_names": [],
                "reference_id": "StorageAccountQueueServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
                "policy_group_names": [],
                "reference_id": "StorageAccountTableServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AVDScalingPlansLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
                "policy_group_names": [],
                "reference_id": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDAppGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
                "policy_group_names": [],
                "reference_id": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
                "policy_group_names": [],
                "reference_id": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDHostPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
                "policy_group_names": [],
                "reference_id": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACILogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
                "policy_group_names": [],
                "reference_id": "ACIDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
                "policy_group_names": [],
                "reference_id": "ACRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('AKSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
                "policy_group_names": [],
                "reference_id": "AKSDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AnalysisServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
                "policy_group_names": [],
                "reference_id": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIforFHIRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
                "policy_group_names": [],
                "reference_id": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIMgmtLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
                "policy_group_names": [],
                "reference_id": "APIMgmtDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApplicationGatewayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
                "policy_group_names": [],
                "reference_id": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
                "policy_group_names": [],
                "reference_id": "AutomationDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BastionLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
                "policy_group_names": [],
                "reference_id": "BastionDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
                "policy_group_names": [],
                "reference_id": "BatchDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CDNEndpointsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
                "policy_group_names": [],
                "reference_id": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
                "policy_group_names": [],
                "reference_id": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
                "policy_group_names": [],
                "reference_id": "CosmosDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DatabricksLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
                "policy_group_names": [],
                "reference_id": "DatabricksDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataExplorerClusterLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
                "policy_group_names": [],
                "reference_id": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataFactoryLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
                "policy_group_names": [],
                "reference_id": "DataFactoryDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeStoreLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
                "policy_group_names": [],
                "reference_id": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
                "policy_group_names": [],
                "reference_id": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridSubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
                "policy_group_names": [],
                "reference_id": "EventGridSubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
                "policy_group_names": [],
                "reference_id": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
                "policy_group_names": [],
                "reference_id": "EventHubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventSystemTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
                "policy_group_names": [],
                "reference_id": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ExpressRouteLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
                "policy_group_names": [],
                "reference_id": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FirewallLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
                "policy_group_names": [],
                "reference_id": "FirewallDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FrontDoorLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
                "policy_group_names": [],
                "reference_id": "FrontDoorDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
                "policy_group_names": [],
                "reference_id": "FunctionAppDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('HDInsightLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
                "policy_group_names": [],
                "reference_id": "HDInsightDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('IotHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
                "policy_group_names": [],
                "reference_id": "IotHubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
                "policy_group_names": [],
                "reference_id": "KeyVaultDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LoadBalancerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
                "policy_group_names": [],
                "reference_id": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsISELogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
                "policy_group_names": [],
                "reference_id": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsWFLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
                "policy_group_names": [],
                "reference_id": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDBLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
                "policy_group_names": [],
                "reference_id": "MariaDBDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MediaServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
                "policy_group_names": [],
                "reference_id": "MediaServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
                "policy_group_names": [],
                "reference_id": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
                "policy_group_names": [],
                "reference_id": "MySQLDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
                "policy_group_names": [],
                "reference_id": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkNICLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
                "policy_group_names": [],
                "reference_id": "NetworkNICDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
                "policy_group_names": [],
                "reference_id": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PowerBIEmbeddedLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
                "policy_group_names": [],
                "reference_id": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkPublicIPNicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"True\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
                "policy_group_names": [],
                "reference_id": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
                "policy_group_names": [],
                "reference_id": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCacheLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
                "policy_group_names": [],
                "reference_id": "RedisCacheDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RelayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
                "policy_group_names": [],
                "reference_id": "RelayDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SearchServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
                "policy_group_names": [],
                "reference_id": "SearchServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ServiceBusLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
                "policy_group_names": [],
                "reference_id": "ServiceBusDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SignalRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
                "policy_group_names": [],
                "reference_id": "SignalRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('SQLDBsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
                "policy_group_names": [],
                "reference_id": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLElasticPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
                "policy_group_names": [],
                "reference_id": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLMLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
                "policy_group_names": [],
                "reference_id": "SQLMDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
                "policy_group_names": [],
                "reference_id": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('TimeSeriesInsightsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
                "policy_group_names": [],
                "reference_id": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('TrafficManagerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
                "policy_group_names": [],
                "reference_id": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualNetworkLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
                "policy_group_names": [],
                "reference_id": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualMachinesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
                "policy_group_names": [],
                "reference_id": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VMSSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
                "policy_group_names": [],
                "reference_id": "VMSSDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VNetGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
                "policy_group_names": [],
                "reference_id": "VNetGWDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
                "policy_group_names": [],
                "reference_id": "AppServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceWebappLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
                "policy_group_names": [],
                "reference_id": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud configuration",
            "display_name": "Deploy Microsoft Defender for Cloud configuration",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Security Center\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-15T00:26:05.515336Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"3.1.1\"}",
            "name": "Deploy-MDFC-Config",
            "parameters": "{\"ascExportResourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource Group location for the export to Log Analytics workspace configuration\"}},\"ascExportResourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource Group name for the export to Log Analytics workspace configuration\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Microsoft Defender for Cloud contact details\",\"displayName\":\"Security contacts email address\"}},\"enableAscForAppServices\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForArm\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForContainers\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForCosmosDbs\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForDns\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForKeyVault\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForOssDb\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForServers\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSql\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSqlOnVm\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForStorage\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"minimalSeverity\":{\"type\":\"string\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForOssDb')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                "policy_group_names": [],
                "reference_id": "defenderForOssDb"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                "policy_group_names": [],
                "reference_id": "defenderForVM"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSqlOnVm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                "policy_group_names": [],
                "reference_id": "defenderForSqlServerVirtualMachines"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForAppServices')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                "policy_group_names": [],
                "reference_id": "defenderForAppServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForStorage')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
                "policy_group_names": [],
                "reference_id": "defenderForStorageAccounts"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                "policy_group_names": [],
                "reference_id": "defenderforContainers"
              },
              {
                "parameter_values": "{\"Effect\":{\"value\":\"[parameters('enableAscForKeyVault')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                "policy_group_names": [],
                "reference_id": "defenderForKeyVaults"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForDns')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                "policy_group_names": [],
                "reference_id": "defenderForDns"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForArm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                "policy_group_names": [],
                "reference_id": "defenderForArm"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSql')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                "policy_group_names": [],
                "reference_id": "defenderForSqlPaas"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCosmosDbs')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                "policy_group_names": [],
                "reference_id": "defenderForCosmosDbs"
              },
              {
                "parameter_values": "{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                "policy_group_names": [],
                "reference_id": "securityEmailContact"
              },
              {
                "parameter_values": "{\"resourceGroupLocation\":{\"value\":\"[parameters('ascExportResourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('ascExportResourceGroupName')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                "policy_group_names": [],
                "reference_id": "ascExport"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
            "display_name": "Configure Azure PaaS services to use private DNS zones",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Network\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:52:50.3529176Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:26:05.3674274Z\",\"version\":\"1.1.0\"}",
            "name": "Deploy-Private-DNS-Zones",
            "parameters": "{\"azureAcrPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAcrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppServicesPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAsrPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAsrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAutomationDSCHybridPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAutomationDSCHybridPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAutomationWebhookPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAutomationWebhookPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureBatchPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureBatchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveSearchPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveSearchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveServicesPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosCassandraPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosCassandraPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosGremlinPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosGremlinPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosMongoPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosMongoPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosSQLPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosSQLPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosTablePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosTablePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDataFactoryPortalPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDataFactoryPortalPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDataFactoryPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDataFactoryPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDiskAccessPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDiskAccessPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridDomainsPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridDomainsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridTopicsPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridTopicsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventHubNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventHubNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureFilePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureHDInsightPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureHDInsightPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotHubsPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotHubsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureKeyVaultPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureKeyVaultPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMachineLearningWorkspacePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMachineLearningWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMediaServicesKeyPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesKeyPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMediaServicesLivePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesLivePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMediaServicesStreamPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesStreamPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMigratePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMigratePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId1\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId1\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId2\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId2\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId3\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId3\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId4\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId4\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId5\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId5\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureRedisCachePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureRedisCachePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureServiceBusNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureServiceBusNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSignalRPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSignalRPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageBlobPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageBlobPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageBlobSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageBlobSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageDFSPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageDFSPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageDFSSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageDFSSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageFilePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageQueuePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageQueuePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageQueueSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageQueueSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageStaticWebPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageStaticWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageStaticWebSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageStaticWebSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSynapseDevPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseDevPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSynapseSQLODPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseSQLODPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSynapseSQLPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseSQLPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureWebPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effect1\":{\"type\":\"string\",\"allowedValues\":[\"deployIfNotExists\",\"Disabled\"],\"defaultValue\":\"deployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureFileprivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-File-Sync"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAutomationWebhookPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Webhook\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Automation-Webhook"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAutomationDSCHybridPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"DSCAndHybridWorker\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Automation-DSCHybrid"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosSQLPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"SQL\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-SQL"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosMongoPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"MongoDB\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-MongoDB"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosCassandraPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Cassandra\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-Cassandra"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosGremlinPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Gremlin\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-Gremlin"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosTablePrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Table\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-Table"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"listOfGroupIds\":{\"value\":[\"dataFactory\"]},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDataFactoryPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-DataFactory"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"listOfGroupIds\":{\"value\":[\"portal\"]},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDataFactoryPortalPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-DataFactory-Portal"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"cluster\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureHDInsightPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-HDInsight"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMigratePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Migrate"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageBlobPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-Blob"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageBlobSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-Blob-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageQueuePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-Queue"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageQueueSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-Queue-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageFilePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-File"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageStaticWebPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-StaticWeb"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageStaticWebSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-StaticWeb-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageDFSPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-DFS"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageDFSSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Storage-DFS-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseSQLPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"Sql\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Synapse-SQL"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseSQLODPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"SqlOnDemand\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Synapse-SQL-OnDemand"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseDevPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"Dev\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Synapse-Dev"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"keydelivery\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesKeyPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-MediaServices-Key"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"liveevent\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesLivePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-MediaServices-Live"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"streamingendpoint\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesStreamPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-MediaServices-Stream"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId1\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId1')]\"},\"privateDnsZoneId2\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId2')]\"},\"privateDnsZoneId3\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId3')]\"},\"privateDnsZoneId4\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId4')]\"},\"privateDnsZoneId5\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId5')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Monitor"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureWebPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Web"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureBatchPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Batch"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-App"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAsrPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Site-Recovery"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-IoT"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureKeyVaultPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-KeyVault"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSignalRPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-SignalR"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppServicesPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-AppServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridTopicsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-EventGridTopics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDiskAccessPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-DiskAccess"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveServicesPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-CognitiveServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotHubsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-IoTHubs"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridDomainsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-EventGridDomains"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureRedisCachePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-RedisCache"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAcrPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-ACR"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventHubNamespacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-EventHubNamespace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMachineLearningWorkspacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-MachineLearningWorkspace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureServiceBusNamespacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-ServiceBusNamespace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveSearchPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-CognitiveSearch"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
            "display_name": "Deploy SQL Database built-in SQL security configuration",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:52:50.4548988Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:26:05.4403382Z\",\"version\":\"1.0.0\"}",
            "name": "Deploy-Sql-Security",
            "parameters": "{\"SqlDbAuditingSettingsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy auditing settings to SQL Database when it not exist in the deployment\",\"displayName\":\"Deploy SQL database auditing settings\"}},\"SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\"displayName\":\"Deploy SQL Database security Alert Policies configuration with email admin accounts\"}},\"SqlDbTdeDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the Transparent Data Encryption when it is not enabled in the deployment\",\"displayName\":\"Deploy SQL Database Transparent Data Encryption \"}},\"SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters\",\"displayName\":\"Deploy SQL Database vulnerability Assessments\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbTdeDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
                "policy_group_names": [],
                "reference_id": "SqlDbTdeDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                "policy_group_names": [],
                "reference_id": "SqlDbSecurityAlertPoliciesDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                "policy_group_names": [],
                "reference_id": "SqlDbAuditingSettingsDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
                "policy_group_names": [],
                "reference_id": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
          "schema_version": 0,
          "attributes": {
            "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing exsistense condition require then the combination of Audit. ",
            "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Encryption\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:52:50.6766882Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:26:05.6281626Z\",\"version\":\"1.0.0\"}",
            "name": "Enforce-EncryptTransit",
            "parameters": "{\"AKSIngressHttpsOnlyEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\",\"displayName\":\"AKS Service. Enforce HTTPS ingress in Kubernetes cluster\"}},\"APIAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"APIAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"App Service API App. Only Audit, deny not possible as it is a related resource.  Upgrade to the latest TLS version.\",\"displayName\":\"App Service API App. Latest TLS version should be used in your API App\"}},\"AppServiceHttpEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below\"}},\"AppServiceTlsVersionEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService WebApp, APIApp, Function App to enable https only\"}},\"AppServiceminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"App Service. Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"App Service. Select version minimum TLS Web App config\"}},\"FunctionLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Function App. Latest TLS version should be used in your Function App\"}},\"FunctionServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"MySQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server\"}},\"MySQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers\"}},\"MySQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"MySQL database servers. Select version minimum TLS for MySQL server\"}},\"PostgreSQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server\"}},\"PostgreSQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers\"}},\"PostgreSQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"PostgreSQL database servers. Select version minimum TLS for MySQL server\"}},\"RedisMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a Azure Cache for Redis to enforce\",\"displayName\":\"Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis\"}},\"RedisTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis\"}},\"RedisTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.\",\"displayName\":\"Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled\"}},\"SQLManagedInstanceMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure Managed Instanceto to  enforce\",\"displayName\":\"Azure Managed Instance.Select version minimum TLS for Azure Managed Instance\"}},\"SQLManagedInstanceTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLManagedInstanceTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"SQL Managed Instance should have the minimal TLS version of 1.2\"}},\"SQLServerTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLServerTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"Azure SQL Database should have the minimal TLS version of 1.2\"}},\"SQLServerminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure SQL Database to enforce\",\"displayName\":\"Azure SQL Database.Select version minimum TLS for Azure SQL Database\"}},\"StorageDeployHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled\"}},\"StorageHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Secure transfer to storage accounts should be enabled\"}},\"StorageminimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}},\"WebAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"WebAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Web App. Latest TLS version should be used in your Web App\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceHttpEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                "policy_group_names": [],
                "reference_id": "AppServiceHttpEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceTlsVersionEffect')]\"},\"minTlsVersion\":{\"value\":\"[parameters('AppServiceminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                "policy_group_names": [],
                "reference_id": "AppServiceminTlsVersion"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
                "policy_group_names": [],
                "reference_id": "APIAppServiceLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                "policy_group_names": [],
                "reference_id": "FunctionLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                "policy_group_names": [],
                "reference_id": "WebAppServiceLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                "policy_group_names": [],
                "reference_id": "APIAppServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                "policy_group_names": [],
                "reference_id": "FunctionServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                "policy_group_names": [],
                "reference_id": "WebAppServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSIngressHttpsOnlyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                "policy_group_names": [],
                "reference_id": "AKSIngressHttpsOnlyEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "MySQLEnableSSLDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                "policy_group_names": [],
                "reference_id": "MySQLEnableSSLEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "PostgreSQLEnableSSLDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                "policy_group_names": [],
                "reference_id": "PostgreSQLEnableSSLEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "RedisTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                "policy_group_names": [],
                "reference_id": "RedisdisableNonSslPort"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                "policy_group_names": [],
                "reference_id": "RedisDenyhttps"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLManagedInstanceTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLManagedInstanceTLSEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLServerTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLServerTLSEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
                "policy_group_names": [],
                "reference_id": "StorageHttpsEnabledEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageDeployHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "StorageDeployHttpsEnabledEffect"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
          "schema_version": 0,
          "attributes": {
            "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
            "display_name": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
            "id": "/providers/Microsoft.Management/managementgroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Encryption\",\"createdBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"createdOn\":\"2023-01-14T04:52:50.4086302Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":\"56277965-2938-4922-9a61-d956b9e0212f\",\"updatedOn\":\"2023-01-15T00:26:05.440299Z\",\"version\":\"1.0.1\"}",
            "name": "Enforce-Encryption-CMK",
            "parameters": "{\"ACRCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK.\",\"displayName\":\"Container registries should be encrypted with a customer-managed key (CMK)\"}},\"AksCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.\",\"displayName\":\"Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys\"}},\"AzureBatchCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK.\",\"displayName\":\"Azure Batch account should use customer-managed keys to encrypt data\"}},\"CognitiveServicesCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)\"}},\"CosmosCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\"}},\"DataBoxCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.\",\"displayName\":\"Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password\"}},\"EncryptedVMDisksEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\"displayName\":\"Disk encryption should be applied on virtual machines\"}},\"HealthcareAPIsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\"displayName\":\"Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest\"}},\"MySQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure MySQL servers bring your own key data protection should be enabled\"}},\"PostgreSQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure PostgreSQL servers bring your own key data protection should be enabled\"}},\"SqlServerTDECMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\"displayName\":\"SQL servers should use customer-managed keys to encrypt data at rest\"}},\"StorageCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\"displayName\":\"Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption\"}},\"StreamAnalyticsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.\",\"displayName\":\"Azure Stream Analytics jobs should use customer-managed keys to encrypt data\"}},\"SynapseWorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.\",\"displayName\":\"Azure Synapse workspaces should use customer-managed keys to encrypt data at rest\"}},\"WorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk.\",\"displayName\":\"Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRCmkEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                "policy_group_names": [],
                "reference_id": "ACRCmkDeny"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AksCmkEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                "policy_group_names": [],
                "reference_id": "AksCmkDeny"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WorkspaceCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                "policy_group_names": [],
                "reference_id": "WorkspaceCMK"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                "policy_group_names": [],
                "reference_id": "CognitiveServicesCMK"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                "policy_group_names": [],
                "reference_id": "CosmosCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataBoxCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                "policy_group_names": [],
                "reference_id": "DataBoxCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                "policy_group_names": [],
                "reference_id": "StreamAnalyticsCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SynapseWorkspaceCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                "policy_group_names": [],
                "reference_id": "SynapseWorkspaceCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                "policy_group_names": [],
                "reference_id": "StorageCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                "policy_group_names": [],
                "reference_id": "MySQLCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                "policy_group_names": [],
                "reference_id": "PostgreSQLCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerTDECMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
                "policy_group_names": [],
                "reference_id": "SqlServerTDECMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('HealthcareAPIsCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                "policy_group_names": [],
                "reference_id": "HealthcareAPIsCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureBatchCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                "policy_group_names": [],
                "reference_id": "AzureBatchCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EncryptedVMDisksEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                "policy_group_names": [],
                "reference_id": "EncryptedVMDisksEffect"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_private_dns_zone",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.adf.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.adf.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.afs.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.afs.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.agentsvc.azure-automation.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.agentsvc.azure-automation.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.analysis.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.analysis.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.api.azureml.ms",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.api.azureml.ms.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azconfig.io",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azconfig.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-api.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-api.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-automation.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-automation.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-devices-provisioning.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-devices-provisioning.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-devices.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-devices.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurecr.io",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurecr.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurehdinsight.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurehdinsight.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurehealthcareapis.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurehealthcareapis.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurestaticapps.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurestaticapps.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azuresynapse.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azuresynapse.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurewebsites.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurewebsites.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.batch.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.batch.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.blob.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.blob.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.cassandra.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.cassandra.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.azmk8s.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.azmk8s.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.centralus.azmk8s.io",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.centralus.azmk8s.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.kusto.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.kusto.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.centralus.kusto.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.centralus.kusto.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.cognitiveservices.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.cognitiveservices.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cus.backup.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cus.backup.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.cus.backup.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.cus.backup.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.database.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.database.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.datafactory.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.datafactory.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.dev.azuresynapse.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.dev.azuresynapse.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.developer.azure-api.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.developer.azure-api.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.dfs.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.dfs.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.dicom.azurehealthcareapis.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.dicom.azurehealthcareapis.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.digitaltwins.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.digitaltwins.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.directline.botframework.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.directline.botframework.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.documents.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.documents.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.azmk8s.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.azmk8s.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.eastus.azmk8s.io",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.eastus.azmk8s.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.kusto.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.kusto.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.eastus.kusto.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.eastus.kusto.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus.backup.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus.backup.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.eus.backup.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.eus.backup.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.eventgrid.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.eventgrid.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.file.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.file.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.gremlin.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.gremlin.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.guestconfiguration.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.guestconfiguration.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.his.arc.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.his.arc.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.kubernetesconfiguration.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.kubernetesconfiguration.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.managedhsm.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.managedhsm.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.mariadb.database.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.mariadb.database.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.media.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.media.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.mongo.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.mongo.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.monitor.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.monitor.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.mysql.database.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.mysql.database.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.notebooks.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.notebooks.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.ods.opinsights.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.ods.opinsights.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.oms.opinsights.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.oms.opinsights.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.pbidedicated.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.pbidedicated.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.postgres.database.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.postgres.database.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.prod.migration.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.prod.migration.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.purview.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.purview.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.purviewstudio.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.purviewstudio.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.queue.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.queue.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.redis.cache.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.redis.cache.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.redisenterprise.cache.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.redisenterprise.cache.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.search.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.search.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.service.signalr.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.service.signalr.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.servicebus.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.servicebus.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.siterecovery.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.siterecovery.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.sql.azuresynapse.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.sql.azuresynapse.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.table.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.table.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.table.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.table.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.tip1.powerquery.microsoft.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.tip1.powerquery.microsoft.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.token.botframework.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.token.botframework.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.vaultcore.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.vaultcore.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.web.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.web.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.webpubsub.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "tf-ds-caf-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.webpubsub.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_private_dns_zone_virtual_network_link",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.adf.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.adf.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.afs.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.afs.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.agentsvc.azure-automation.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.agentsvc.azure-automation.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.analysis.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.analysis.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.api.azureml.ms",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.api.azureml.ms",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azconfig.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azconfig.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azure-api.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azure-api.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azure-automation.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azure-automation.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azure-devices-provisioning.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azure-devices-provisioning.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azure-devices.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azure-devices.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azurecr.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azurecr.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azurehdinsight.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azurehdinsight.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azurehealthcareapis.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azurehealthcareapis.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azurestaticapps.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azurestaticapps.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.azurewebsites.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.azurewebsites.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.batch.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.batch.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.blob.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.blob.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.cassandra.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.cassandra.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.centralus.azmk8s.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.centralus.azmk8s.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.centralus.kusto.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.centralus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.centralus.kusto.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.cognitiveservices.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.cognitiveservices.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.cus.backup.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.cus.backup.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.database.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.database.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.datafactory.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.datafactory.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.dev.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.dev.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.developer.azure-api.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.developer.azure-api.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.dfs.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.dfs.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.dicom.azurehealthcareapis.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.dicom.azurehealthcareapis.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.digitaltwins.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.digitaltwins.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.directline.botframework.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.directline.botframework.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.documents.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.documents.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.eastus.azmk8s.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.azmk8s.io/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.eastus.azmk8s.io",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.eastus.kusto.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eastus.kusto.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.eastus.kusto.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.eus.backup.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eus.backup.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.eus.backup.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.eventgrid.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.eventgrid.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.file.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.file.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.gremlin.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.gremlin.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.guestconfiguration.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.guestconfiguration.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.his.arc.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.his.arc.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.kubernetesconfiguration.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.kubernetesconfiguration.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.managedhsm.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.managedhsm.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.mariadb.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.mariadb.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.media.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.media.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.mongo.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.mongo.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.monitor.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.monitor.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.mysql.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.mysql.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.notebooks.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.notebooks.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.ods.opinsights.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.ods.opinsights.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.oms.opinsights.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.oms.opinsights.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.pbidedicated.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.pbidedicated.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.postgres.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.postgres.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.prod.migration.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.prod.migration.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.purview.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.purview.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.purviewstudio.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.purviewstudio.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.queue.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.queue.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.redis.cache.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.redis.cache.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.redisenterprise.cache.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.redisenterprise.cache.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.search.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.search.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.service.signalr.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.service.signalr.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.servicebus.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.servicebus.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.siterecovery.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.siterecovery.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.sql.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.sql.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.table.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.table.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.table.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.table.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.tip1.powerquery.microsoft.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.tip1.powerquery.microsoft.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.token.botframework.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.token.botframework.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.vaultcore.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.vaultcore.azure.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.web.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.web.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-c52188e2-768c-5ebb-9407-87ed217fcce4",
            "private_dns_zone_name": "privatelink.webpubsub.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com/virtualNetworkLinks/659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "name": "659db95c-d840-4ce0-9a6e-68ac0077d8d5-f9243cf3-0d53-5d8e-845b-6a2903a3f815",
            "private_dns_zone_name": "privatelink.webpubsub.azure.com",
            "registration_enabled": false,
            "resource_group_name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "virtual_network_id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_public_ip",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/publicIPAddresses/tf-ds-caf-ergw-centralus-pip",
          "schema_version": 0,
          "attributes": {
            "allocation_method": "Static",
            "ddos_protection_mode": "VirtualNetworkInherited",
            "ddos_protection_plan_id": null,
            "domain_name_label": null,
            "edge_zone": "",
            "fqdn": null,
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/publicIPAddresses/tf-ds-caf-ergw-centralus-pip",
            "idle_timeout_in_minutes": 4,
            "ip_address": "20.106.25.181",
            "ip_tags": null,
            "ip_version": "IPv4",
            "location": "centralus",
            "name": "tf-ds-caf-ergw-centralus-pip",
            "public_ip_prefix_id": null,
            "resource_group_name": "tf-ds-caf-connectivity-centralus",
            "reverse_fqdn": null,
            "sku": "Standard",
            "sku_tier": "Regional",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "zones": [
              "1",
              "2",
              "3"
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/publicIPAddresses/tf-ds-caf-fw-centralus-pip",
          "schema_version": 0,
          "attributes": {
            "allocation_method": "Static",
            "ddos_protection_mode": "VirtualNetworkInherited",
            "ddos_protection_plan_id": null,
            "domain_name_label": null,
            "edge_zone": "",
            "fqdn": null,
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/publicIPAddresses/tf-ds-caf-fw-centralus-pip",
            "idle_timeout_in_minutes": 4,
            "ip_address": "20.106.25.122",
            "ip_tags": null,
            "ip_version": "IPv4",
            "location": "centralus",
            "name": "tf-ds-caf-fw-centralus-pip",
            "public_ip_prefix_id": null,
            "resource_group_name": "tf-ds-caf-connectivity-centralus",
            "reverse_fqdn": null,
            "sku": "Standard",
            "sku_tier": "Regional",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "zones": [
              "1",
              "2",
              "3"
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/publicIPAddresses/tf-ds-caf-vpngw-eastus-pip",
          "schema_version": 0,
          "attributes": {
            "allocation_method": "Static",
            "ddos_protection_mode": "VirtualNetworkInherited",
            "ddos_protection_plan_id": null,
            "domain_name_label": null,
            "edge_zone": "",
            "fqdn": null,
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/publicIPAddresses/tf-ds-caf-vpngw-eastus-pip",
            "idle_timeout_in_minutes": 4,
            "ip_address": "52.226.247.66",
            "ip_tags": null,
            "ip_version": "IPv4",
            "location": "eastus",
            "name": "tf-ds-caf-vpngw-eastus-pip",
            "public_ip_prefix_id": null,
            "resource_group_name": "tf-ds-caf-connectivity-eastus",
            "reverse_fqdn": null,
            "sku": "Standard",
            "sku_tier": "Regional",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "zones": [
              "1",
              "2",
              "3"
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus",
            "location": "centralus",
            "name": "tf-ds-caf-connectivity-centralus",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus",
            "location": "eastus",
            "name": "tf-ds-caf-connectivity-eastus",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos",
            "location": "centralus",
            "name": "tf-ds-caf-ddos",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-dns",
            "location": "centralus",
            "name": "tf-ds-caf-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-mgmt",
            "location": "centralus",
            "name": "tf-ds-caf-mgmt",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_definition",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/0fd7cbcd-8405-5a26-a8a7-990b0ac7390d",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/tf-ds-caf"
            ],
            "description": "Delegated role for subscription owner generated from subscription Owner role",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/0fd7cbcd-8405-5a26-a8a7-990b0ac7390d|/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "name": "[TF-DS-CAF] Subscription-Owner",
            "permissions": [
              {
                "actions": [
                  "*"
                ],
                "data_actions": [],
                "not_actions": [
                  "Microsoft.Authorization/*/write",
                  "Microsoft.Network/vpnGateways/*",
                  "Microsoft.Network/expressRouteCircuits/*",
                  "Microsoft.Network/routeTables/write",
                  "Microsoft.Network/vpnSites/*"
                ],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "0fd7cbcd-8405-5a26-a8a7-990b0ac7390d",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/0fd7cbcd-8405-5a26-a8a7-990b0ac7390d",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/65d801ee-87c2-5dec-90b1-0b6cad4f2152",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/tf-ds-caf"
            ],
            "description": "Enterprise-scale custom Role Definition. Grants full access to manage Virtual Network subnets, but no other network resources.",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/65d801ee-87c2-5dec-90b1-0b6cad4f2152|/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "name": "[TF-DS-CAF] Network-Subnet-Contributor",
            "permissions": [
              {
                "actions": [
                  "Microsoft.Authorization/*/read",
                  "Microsoft.Insights/alertRules/*",
                  "Microsoft.ResourceHealth/availabilityStatuses/read",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Resources/subscriptions/resourceGroups/read",
                  "Microsoft.Support/*",
                  "Microsoft.Network/*/read",
                  "Microsoft.Network/virtualNetworks/subnets/*"
                ],
                "data_actions": [],
                "not_actions": [],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "65d801ee-87c2-5dec-90b1-0b6cad4f2152",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/65d801ee-87c2-5dec-90b1-0b6cad4f2152",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/71dcf135-46ab-5a1d-a9b8-2b752ea97b2e",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/tf-ds-caf"
            ],
            "description": "Platform-wide global connectivity management: virtual networks, UDRs, NSGs, NVAs, VPN, Azure ExpressRoute, and others",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/71dcf135-46ab-5a1d-a9b8-2b752ea97b2e|/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "name": "[TF-DS-CAF] Network-Management",
            "permissions": [
              {
                "actions": [
                  "*/read",
                  "Microsoft.Network/*",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Support/*"
                ],
                "data_actions": [],
                "not_actions": [],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "71dcf135-46ab-5a1d-a9b8-2b752ea97b2e",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/71dcf135-46ab-5a1d-a9b8-2b752ea97b2e",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/eae68634-7030-58e8-a100-77bf4765d1fc",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/tf-ds-caf"
            ],
            "description": "Contributor role granted for application/operations team at resource group level",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/eae68634-7030-58e8-a100-77bf4765d1fc|/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "name": "[TF-DS-CAF] Application-Owners",
            "permissions": [
              {
                "actions": [
                  "*"
                ],
                "data_actions": [],
                "not_actions": [
                  "Microsoft.Authorization/*/write",
                  "Microsoft.Network/publicIPAddresses/write",
                  "Microsoft.Network/virtualNetworks/write",
                  "Microsoft.KeyVault/locations/deletedVaults/purge/action"
                ],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "eae68634-7030-58e8-a100-77bf4765d1fc",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/eae68634-7030-58e8-a100-77bf4765d1fc",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/f390ab37-59e3-5e94-b771-8f6f1654f478",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/tf-ds-caf"
            ],
            "description": "Security Administrator role with a horizontal view across the entire Azure estate and the Azure Key Vault purge policy.",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/f390ab37-59e3-5e94-b771-8f6f1654f478|/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "name": "[TF-DS-CAF] Security-Operations",
            "permissions": [
              {
                "actions": [
                  "*/read",
                  "*/register/action",
                  "Microsoft.KeyVault/locations/deletedVaults/purge/action",
                  "Microsoft.PolicyInsights/*",
                  "Microsoft.Authorization/policyAssignments/*",
                  "Microsoft.Authorization/policyDefinitions/*",
                  "Microsoft.Authorization/policyExemptions/*",
                  "Microsoft.Authorization/policySetDefinitions/*",
                  "Microsoft.Insights/alertRules/*",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Security/*",
                  "Microsoft.Support/*"
                ],
                "data_actions": [],
                "not_actions": [],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "f390ab37-59e3-5e94-b771-8f6f1654f478",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/f390ab37-59e3-5e94-b771-8f6f1654f478",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus/subnets/GatewaySubnet",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.101.1.0/24"
            ],
            "delegation": [],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus/subnets/GatewaySubnet",
            "name": "GatewaySubnet",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "tf-ds-caf-connectivity-eastus",
            "service_endpoint_policy_ids": null,
            "service_endpoints": null,
            "timeouts": null,
            "virtual_network_name": "tf-ds-caf-hub-eastus"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/providers/Microsoft.Resources/deployments/pid-97603aac-98f8-4a55-92fc-4c78378c9ba5_v3.1.2_000d_ce9735aa",
            "location": "centralus",
            "name": "pid-97603aac-98f8-4a55-92fc-4c78378c9ba5_v3.1.2_000d_ce9735aa",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": null,
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "module.enterprise_scale.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_core",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/providers/Microsoft.Resources/deployments/pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v3.1.2_001f_ce9735aa",
            "location": "centralus",
            "name": "pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v3.1.2_001f_ce9735aa",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": {},
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.enterprise_scale.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/providers/Microsoft.Resources/deployments/pid-6fffb9f9-2691-412a-837e-3f72dcfe70cb_v3.1.2_0003_ce9735aa",
            "location": "centralus",
            "name": "pid-6fffb9f9-2691-412a-837e-3f72dcfe70cb_v3.1.2_0003_ce9735aa",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": {},
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "module.enterprise_scale.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus",
          "schema_version": 0,
          "attributes": {
            "address_space": [
              "10.100.0.0/16"
            ],
            "bgp_community": "",
            "ddos_protection_plan": [
              {
                "enable": true,
                "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos/providers/Microsoft.Network/ddosProtectionPlans/tf-ds-caf-ddos-centralus"
              }
            ],
            "dns_servers": [],
            "edge_zone": "",
            "flow_timeout_in_minutes": 0,
            "guid": "7b80ea5d-d318-4002-9f86-5dd3149cca4a",
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus",
            "location": "centralus",
            "name": "tf-ds-caf-hub-centralus",
            "resource_group_name": "tf-ds-caf-connectivity-centralus",
            "subnet": [
              {
                "address_prefix": "10.100.0.0/24",
                "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus/subnets/AzureFirewallSubnet",
                "name": "AzureFirewallSubnet",
                "security_group": ""
              },
              {
                "address_prefix": "10.100.1.0/24",
                "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-centralus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-centralus/subnets/GatewaySubnet",
                "name": "GatewaySubnet",
                "security_group": ""
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus",
          "schema_version": 0,
          "attributes": {
            "address_space": [
              "10.101.0.0/16"
            ],
            "bgp_community": "",
            "ddos_protection_plan": [
              {
                "enable": true,
                "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-ddos/providers/Microsoft.Network/ddosProtectionPlans/tf-ds-caf-ddos-centralus"
              }
            ],
            "dns_servers": [],
            "edge_zone": "",
            "flow_timeout_in_minutes": 0,
            "guid": "f0ad0193-b1f4-4620-81cc-24b6b9be3b62",
            "id": "/subscriptions/659db95c-d840-4ce0-9a6e-68ac0077d8d5/resourceGroups/tf-ds-caf-connectivity-eastus/providers/Microsoft.Network/virtualNetworks/tf-ds-caf-hub-eastus",
            "location": "eastus",
            "name": "tf-ds-caf-hub-eastus",
            "resource_group_name": "tf-ds-caf-connectivity-eastus",
            "subnet": [],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network_gateway",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "random_id",
      "name": "telem",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "b64_std": "zpc1qg==",
            "b64_url": "zpc1qg",
            "byte_length": 4,
            "dec": "3466016170",
            "hex": "ce9735aa",
            "id": "zpc1qg",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_management_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2023-01-14T05:19:37Z",
            "triggers": {
              "azurerm_management_group_level_1": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf\"]",
              "azurerm_management_group_level_2": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-decommissioned\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-platform\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-sandboxes\"]",
              "azurerm_management_group_level_3": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-docsquad-tf\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-management\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-online\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-sap\"]",
              "azurerm_management_group_level_4": "[]",
              "azurerm_management_group_level_5": "[]",
              "azurerm_management_group_level_6": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2023-01-15T00:32:21Z",
            "triggers": {
              "azurerm_management_group_policy_assignment_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Pip\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Sku\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-DataB-Vnet\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deny-Public-Endpoints\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2023-01-15T00:26:04Z",
            "triggers": {
              "azurerm_policy_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_set_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2023-01-15T00:30:11Z",
            "triggers": {
              "azurerm_policy_set_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "0s",
            "destroy_duration": "0s",
            "id": "2023-01-15T00:33:26Z",
            "triggers": {
              "azurerm_role_assignment_enterprise_scale": "[]",
              "module_role_assignments_for_policy": "[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.azurerm_role_definition.enterprise_scale",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.module.role_assignments_for_policy.azurerm_role_assignment.for_policy",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_role_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "60s",
            "destroy_duration": "0s",
            "id": "2023-01-15T00:05:45Z",
            "triggers": {
              "azurerm_role_definition_enterprise_scale": "[\"/providers/Microsoft.Authorization/roleDefinitions/0fd7cbcd-8405-5a26-a8a7-990b0ac7390d\",\"/providers/Microsoft.Authorization/roleDefinitions/65d801ee-87c2-5dec-90b1-0b6cad4f2152\",\"/providers/Microsoft.Authorization/roleDefinitions/71dcf135-46ab-5a1d-a9b8-2b752ea97b2e\",\"/providers/Microsoft.Authorization/roleDefinitions/eae68634-7030-58e8-a100-77bf4765d1fc\",\"/providers/Microsoft.Authorization/roleDefinitions/f390ab37-59e3-5e94-b771-8f6f1654f478\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_role_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/roleAssignments/53765765-33cd-55de-bb0b-92cc817e284b",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity/providers/Microsoft.Authorization/roleAssignments/53765765-33cd-55de-bb0b-92cc817e284b",
            "name": "53765765-33cd-55de-bb0b-92cc817e284b",
            "principal_id": "019bd241-7ab1-4c2d-9928-7d1f65562a57",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-connectivity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/policyAssignments/Deploy-Private-DNS-Zones\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/roleAssignments/10fe9e78-a081-570d-b33e-9782cd20854a",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/roleAssignments/10fe9e78-a081-570d-b33e-9782cd20854a",
            "name": "10fe9e78-a081-570d-b33e-9782cd20854a",
            "principal_id": "5d9ab15a-cb68-4450-bb45-f3594d04ad60",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/roleAssignments/ba11693c-a55f-50e4-a8ce-4abd963d52be",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/roleAssignments/ba11693c-a55f-50e4-a8ce-4abd963d52be",
            "name": "ba11693c-a55f-50e4-a8ce-4abd963d52be",
            "principal_id": "5d9ab15a-cb68-4450-bb45-f3594d04ad60",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/roleAssignments/f957ed47-154b-5e74-b60a-6a1129bafa07",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp/providers/Microsoft.Authorization/roleAssignments/f957ed47-154b-5e74-b60a-6a1129bafa07",
            "name": "f957ed47-154b-5e74-b60a-6a1129bafa07",
            "principal_id": "5d9ab15a-cb68-4450-bb45-f3594d04ad60",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f",
            "role_definition_name": "Private DNS Zone Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-corp",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/roleAssignments/701b9ffa-81c0-5bc7-8240-6e22da3cd5a0",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/roleAssignments/701b9ffa-81c0-5bc7-8240-6e22da3cd5a0",
            "name": "701b9ffa-81c0-5bc7-8240-6e22da3cd5a0",
            "principal_id": "899e34e9-34de-45fd-80b9-888ee58d9efe",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
            "role_definition_name": "Backup Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/roleAssignments/9cde9348-0bab-5e34-a7a5-b4b270cd4c4e",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity/providers/Microsoft.Authorization/roleAssignments/9cde9348-0bab-5e34-a7a5-b4b270cd4c4e",
            "name": "9cde9348-0bab-5e34-a7a5-b4b270cd4c4e",
            "principal_id": "899e34e9-34de-45fd-80b9-888ee58d9efe",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-identity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/a10fdca4-68d4-5ea8-bf3d-042815c95b40",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/a10fdca4-68d4-5ea8-bf3d-042815c95b40",
            "name": "a10fdca4-68d4-5ea8-bf3d-042815c95b40",
            "principal_id": "dc632dc6-1f31-4ec9-ad82-f3c9338740f0",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
            "role_definition_name": "Azure Kubernetes Service Contributor Role",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/d0805219-9bf3-539e-8540-215da479708a",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/d0805219-9bf3-539e-8540-215da479708a",
            "name": "d0805219-9bf3-539e-8540-215da479708a",
            "principal_id": "dc632dc6-1f31-4ec9-ad82-f3c9338740f0",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
            "role_definition_name": "Azure Kubernetes Service Policy Add-on Deployment",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/348e215d-d146-5b73-a179-7e88120d4867",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/348e215d-d146-5b73-a179-7e88120d4867",
            "name": "348e215d-d146-5b73-a179-7e88120d4867",
            "principal_id": "d75bf7c3-7877-41d6-906c-7e689f77634f",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
            "role_definition_name": "SQL Security Manager",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/a7cf19c8-a162-544b-b5a4-6ec8bcac5362",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/a7cf19c8-a162-544b-b5a4-6ec8bcac5362",
            "name": "a7cf19c8-a162-544b-b5a4-6ec8bcac5362",
            "principal_id": "839b877e-0a0b-40c4-b824-2027d76c046e",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
            "role_definition_name": "Backup Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/d4a75cc9-0f6c-52a4-bbd8-69537be9cd43",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/d4a75cc9-0f6c-52a4-bbd8-69537be9cd43",
            "name": "d4a75cc9-0f6c-52a4-bbd8-69537be9cd43",
            "principal_id": "839b877e-0a0b-40c4-b824-2027d76c046e",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/a3a29c71-8c77-5bf6-9423-da1c94cc9974",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/a3a29c71-8c77-5bf6-9423-da1c94cc9974",
            "name": "a3a29c71-8c77-5bf6-9423-da1c94cc9974",
            "principal_id": "06adc35d-4674-43dc-ad3c-54831ea057df",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/9256939f-aab9-5e0b-9ded-f27474a01ef6",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones/providers/Microsoft.Authorization/roleAssignments/9256939f-aab9-5e0b-9ded-f27474a01ef6",
            "name": "9256939f-aab9-5e0b-9ded-f27474a01ef6",
            "principal_id": "23b42206-2ef5-4cdd-9d82-3b74cfff455d",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
            "role_definition_name": "Owner",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/roleAssignments/87808798-37c9-50a4-976f-c9a76b1968cc",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management/providers/Microsoft.Authorization/roleAssignments/87808798-37c9-50a4-976f-c9a76b1968cc",
            "name": "87808798-37c9-50a4-976f-c9a76b1968cc",
            "principal_id": "153529cd-c538-4875-baa9-794b67309e1f",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf-management",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/243c03c9-5cba-58a8-b2d7-5d4d6619f3c8",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/243c03c9-5cba-58a8-b2d7-5d4d6619f3c8",
            "name": "243c03c9-5cba-58a8-b2d7-5d4d6619f3c8",
            "principal_id": "8e237346-4385-4c10-b7c9-69227baf8432",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
            "role_definition_name": "Monitoring Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/8170fc6e-0e79-57c9-93c6-9b5014d99563",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/8170fc6e-0e79-57c9-93c6-9b5014d99563",
            "name": "8170fc6e-0e79-57c9-93c6-9b5014d99563",
            "principal_id": "8e237346-4385-4c10-b7c9-69227baf8432",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/9eaedb1b-5e81-5c66-b782-2da92303b886",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/9eaedb1b-5e81-5c66-b782-2da92303b886",
            "name": "9eaedb1b-5e81-5c66-b782-2da92303b886",
            "principal_id": "53ec45a0-de38-40a3-85fb-3dea49acf11b",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd",
            "role_definition_name": "Security Admin",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/f0645e58-7027-5560-8780-6bade9bcff1d",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/f0645e58-7027-5560-8780-6bade9bcff1d",
            "name": "f0645e58-7027-5560-8780-6bade9bcff1d",
            "principal_id": "53ec45a0-de38-40a3-85fb-3dea49acf11b",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/22abe626-d8aa-5d55-91a7-3008505722ab",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/22abe626-d8aa-5d55-91a7-3008505722ab",
            "name": "22abe626-d8aa-5d55-91a7-3008505722ab",
            "principal_id": "ffa21e53-b57b-463d-8ab0-7564f28e5eba",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
            "role_definition_name": "Monitoring Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/81366d10-c30a-58ff-8518-7b47110c2617",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/81366d10-c30a-58ff-8518-7b47110c2617",
            "name": "81366d10-c30a-58ff-8518-7b47110c2617",
            "principal_id": "ffa21e53-b57b-463d-8ab0-7564f28e5eba",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/fa5455d5-350f-5f28-ba19-0a4e3f9a118e",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/fa5455d5-350f-5f28-ba19-0a4e3f9a118e",
            "name": "fa5455d5-350f-5f28-ba19-0a4e3f9a118e",
            "principal_id": "231ea7d5-704d-4ec7-b65a-3da341c7cc07",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/1a337423-db7d-5ef5-80f8-ada02959c8f4",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/1a337423-db7d-5ef5-80f8-ada02959c8f4",
            "name": "1a337423-db7d-5ef5-80f8-ada02959c8f4",
            "principal_id": "e4c9aa13-d36f-4b02-9258-ad8e5c7ab00c",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/75772ad7-a23f-5ea9-ba0f-35ef316f7117",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/tf-ds-caf/providers/Microsoft.Authorization/roleAssignments/75772ad7-a23f-5ea9-ba0f-35ef316f7117",
            "name": "75772ad7-a23f-5ea9-ba0f-35ef316f7117",
            "principal_id": "e4c9aa13-d36f-4b02-9258-ad8e5c7ab00c",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/tf-ds-caf",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.connectivity",
            "data.azurerm_client_config.current",
            "data.azurerm_client_config.management",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
